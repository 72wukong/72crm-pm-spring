(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4f299ef8","chunk-1ac799d4"],{"041c":function(t,e,a){},"0492":function(t,e,a){},"0cd3":function(t,e,a){},1019:function(t,e,a){"use strict";a("8067")},1557:function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"status-tag"},[a("span",{staticClass:"status-name",style:t.getStyle},[t._v(t._s(t.name))])])},n=[],s=(a("a9e3"),{name:"StatusTag",props:{type:[String,Number],statusName:String},data:function(){return{group:["",{color:"#0052CC","background-color":"#DEEBFF"},{color:"#EC8205","background-color":"#FFEACF"},{color:"#006644","background-color":"#E3FCEF"}]}},computed:{convertType:function(){return Number(this.type)},name:function(){return this.statusName?this.statusName:["","未开始","进行中","已完成"][this.convertType]},getStyle:function(){return this.group[this.convertType]}},methods:{}}),o=s,r=(a("77bc"),a("2877")),c=Object(r["a"])(o,i,n,!1,null,"2a8a7a12",null);e["a"]=c.exports},1658:function(t,e,a){"use strict";a.d(e,"W",(function(){return n})),a.d(e,"qb",(function(){return s})),a.d(e,"N",(function(){return o})),a.d(e,"U",(function(){return r})),a.d(e,"P",(function(){return c})),a.d(e,"O",(function(){return l})),a.d(e,"H",(function(){return d})),a.d(e,"I",(function(){return u})),a.d(e,"G",(function(){return p})),a.d(e,"T",(function(){return h})),a.d(e,"R",(function(){return m})),a.d(e,"V",(function(){return f})),a.d(e,"Q",(function(){return b})),a.d(e,"S",(function(){return g})),a.d(e,"F",(function(){return v})),a.d(e,"K",(function(){return k})),a.d(e,"h",(function(){return y})),a.d(e,"e",(function(){return T})),a.d(e,"g",(function(){return w})),a.d(e,"D",(function(){return C})),a.d(e,"b",(function(){return j})),a.d(e,"y",(function(){return _})),a.d(e,"B",(function(){return I})),a.d(e,"z",(function(){return D})),a.d(e,"A",(function(){return x})),a.d(e,"x",(function(){return L})),a.d(e,"v",(function(){return O})),a.d(e,"d",(function(){return S})),a.d(e,"E",(function(){return A})),a.d(e,"u",(function(){return N})),a.d(e,"a",(function(){return U})),a.d(e,"f",(function(){return P})),a.d(e,"w",(function(){return F})),a.d(e,"M",(function(){return H})),a.d(e,"J",(function(){return E})),a.d(e,"gb",(function(){return $})),a.d(e,"nb",(function(){return R})),a.d(e,"fb",(function(){return B})),a.d(e,"pb",(function(){return W})),a.d(e,"hb",(function(){return q})),a.d(e,"jb",(function(){return M})),a.d(e,"ob",(function(){return z})),a.d(e,"ib",(function(){return Y})),a.d(e,"lb",(function(){return V})),a.d(e,"kb",(function(){return J})),a.d(e,"mb",(function(){return G})),a.d(e,"Y",(function(){return K})),a.d(e,"bb",(function(){return X})),a.d(e,"L",(function(){return Q})),a.d(e,"ab",(function(){return Z})),a.d(e,"Z",(function(){return tt})),a.d(e,"X",(function(){return et})),a.d(e,"cb",(function(){return at})),a.d(e,"eb",(function(){return it})),a.d(e,"db",(function(){return nt})),a.d(e,"r",(function(){return st})),a.d(e,"i",(function(){return ot})),a.d(e,"l",(function(){return rt})),a.d(e,"k",(function(){return ct})),a.d(e,"j",(function(){return lt})),a.d(e,"s",(function(){return dt})),a.d(e,"t",(function(){return ut})),a.d(e,"q",(function(){return pt})),a.d(e,"o",(function(){return ht})),a.d(e,"n",(function(){return mt})),a.d(e,"p",(function(){return ft})),a.d(e,"m",(function(){return bt})),a.d(e,"C",(function(){return gt})),a.d(e,"c",(function(){return vt})),a.d(e,"rb",(function(){return kt}));a("99af"),a("d3b7"),a("159b"),a("b64b");var i=a("b775");function n(t){return Object(i["a"])({url:"projectTask/saveProjectTask",method:"post",data:t,headers:{"Content-Type":"application/json;charset=UTF-8"}})}function s(t){return Object(i["a"])({url:"projectTask/updateProjectTask",method:"post",data:t,headers:{"Content-Type":"application/json;charset=UTF-8"}})}function o(t){return Object(i["a"])({url:"projectTask/deleteTask/".concat(t.taskId),method:"post"})}function r(t){return Object(i["a"])({url:"projectTask/queryProjectPlanTaskList",method:"post",data:t,headers:{"Content-Type":"application/json;charset=UTF-8"}})}function c(t){return Object(i["a"])({url:"projectFieldSort/list",method:"post",data:t,headers:{"Content-Type":"application/json;charset=UTF-8"}})}function l(t){return Object(i["a"])({url:"projectFieldSort/addOrUpdate",method:"post",data:t,headers:{"Content-Type":"application/json;charset=UTF-8"}})}function d(t){return Object(i["a"])({url:"projectTask/setProjectTaskName",method:"post",data:t,headers:{"Content-Type":"application/json;charset=UTF-8"}})}function u(t){return Object(i["a"])({url:"projectTask/updateProjectTaskTime",method:"post",data:t,headers:{"Content-Type":"application/json;charset=UTF-8"}})}function p(t){return Object(i["a"])({url:"projectTask/setProjectTaskDescription",method:"post",data:t,headers:{"Content-Type":"application/json;charset=UTF-8"}})}function h(t){return Object(i["a"])({url:"projectTask/queryProjectIterationTaskList",method:"post",data:t,headers:{"Content-Type":"application/json;charset=UTF-8"}})}function m(t){return Object(i["a"])({url:"projectTask/queryProjectTaskList",method:"post",data:t,headers:{"Content-Type":"application/json;charset=UTF-8"}})}function f(t){return Object(i["a"])({url:"projectTask/queryUserTaskList",method:"post",data:t,headers:{"Content-Type":"application/json;charset=UTF-8"}})}function b(t){return Object(i["a"])({url:"projectTask/getProjectTaskDetails/".concat(t.taskId),method:"post"})}function g(t){return Object(i["a"])({url:"projectTask/queryProjectTaskChildList",method:"post",headers:{"Content-Type":"application/json;charset=UTF-8"},data:t})}function v(t){return Object(i["a"])({url:"projectTask/setProjectTaskMainUser",method:"post",headers:{"Content-Type":"application/json;charset=UTF-8"},data:t})}function k(t){return Object(i["a"])({url:"projectTask/startBelongIteration",method:"post",headers:{"Content-Type":"application/json;charset=UTF-8"},data:t})}function y(t){return Object(i["a"])({url:"projectTask/stopBelongIteration",method:"post",headers:{"Content-Type":"application/json;charset=UTF-8"},data:t})}function T(t){return Object(i["a"])({url:"projectTask/belongIterationDel/".concat(t.taskId),method:"post"})}function w(t){return Object(i["a"])({url:"projectTask/belongIterationDetails/".concat(t.taskId),method:"post"})}function C(t){return Object(i["a"])({url:"projectBelongIteration/relevancyBelongIteration",method:"post",headers:{"Content-Type":"application/json;charset=UTF-8"},data:t})}function j(t){return Object(i["a"])({url:"projectTaskTime/addProjectTaskTime",method:"post",data:t,headers:{"Content-Type":"application/json;charset=UTF-8"}})}function _(t){return Object(i["a"])({url:"projectBoardTask/queryBoardList",method:"post",headers:{"Content-Type":"application/json;charset=UTF-8"},data:t})}function I(t){return Object(i["a"])({url:"projectTask/queryProjectTaskChildBoardList",method:"post",headers:{"Content-Type":"application/json;charset=UTF-8"},data:t})}function D(t){return Object(i["a"])({url:"projectBoard/queryBoardList",method:"post",data:t})}function x(t){return Object(i["a"])({url:"projectBoard/resetBoard",method:"post",headers:{"Content-Type":"application/json;charset=UTF-8"},data:t})}function L(t){return Object(i["a"])({url:"projectBoard/notAddStatus",method:"post",data:t})}function O(t){return Object(i["a"])({url:"projectTaskComment/queryCommentList",method:"post",data:t})}function S(t){return Object(i["a"])({url:"projectTaskComment/deleteComment",method:"post",data:t})}function A(t){return Object(i["a"])({url:"projectTaskComment/setComment",method:"post",data:t,headers:{"Content-Type":"application/json;charset=UTF-8"}})}function N(t){return Object(i["a"])({url:"projectTaskLog/queryTaskLog/".concat(t.taskId,"/").concat(t.type),method:"post"})}function U(t){return Object(i["a"])({url:"projectLabel/add",method:"post",data:t,headers:{"Content-Type":"application/json;charset=UTF-8"}})}function P(t){return Object(i["a"])({url:"projectLabel/delete",method:"post",data:t})}function F(t){return Object(i["a"])({url:"projectLabel/queryList",method:"post",data:t})}function H(t){return Object(i["a"])({url:"projectLabel/update",method:"post",data:t,headers:{"Content-Type":"application/json;charset=UTF-8"}})}function E(t){return Object(i["a"])({url:"projectLabel/updateTaskLabel",method:"post",data:t})}function $(t){return Object(i["a"])({url:"workTask/deleteWorkTask/".concat(t),method:"post"})}function R(t){return Object(i["a"])({url:"workTask/setWorkTaskStatus",method:"post",data:t,headers:{"Content-Type":"application/json;charset=UTF-8"}})}function B(t){return Object(i["a"])({url:"workTask/setWorkChildTaskStatus",method:"post",data:t,headers:{"Content-Type":"application/json;charset=UTF-8"}})}function W(t){return Object(i["a"])({url:"workTask/setWorkTaskTitle",method:"post",data:t,headers:{"Content-Type":"application/json;charset=UTF-8"}})}function q(t){return Object(i["a"])({url:"workTask/setWorkTaskDescription",method:"post",data:t,headers:{"Content-Type":"application/json;charset=UTF-8"}})}function M(t){return Object(i["a"])({url:"workTask/setWorkTaskMainUser",method:"post",data:t,headers:{"Content-Type":"application/json;charset=UTF-8"}})}function z(t){return Object(i["a"])({url:"workTask/setWorkTaskTime",method:"post",data:t,headers:{"Content-Type":"application/json;charset=UTF-8"}})}function Y(t){return Object(i["a"])({url:"workTask/setWorkTaskLabel",method:"post",data:t,headers:{"Content-Type":"application/json;charset=UTF-8"}})}function V(t){return Object(i["a"])({url:"workTask/setWorkTaskOwnerUser",method:"post",data:t,headers:{"Content-Type":"application/json;charset=UTF-8"}})}function J(t){return Object(i["a"])({url:"workTask/deleteWorkTaskOwnerUser",method:"post",data:t,headers:{"Content-Type":"application/json;charset=UTF-8"}})}function G(t){return Object(i["a"])({url:"workTask/setWorkTaskPriority",method:"post",data:t,headers:{"Content-Type":"application/json;charset=UTF-8"}})}function K(t){return Object(i["a"])({url:"projectTask/setPriority",method:"post",data:t,headers:{"Content-Type":"application/json;charset=UTF-8"}})}function X(t){return Object(i["a"])({url:"projectTask/setProjectWrongType",method:"post",data:t,headers:{"Content-Type":"application/json;charset=UTF-8"}})}function Q(t){return Object(i["a"])({url:"projectTask/upLoadFileRelationLog",method:"post",data:t,headers:{"Content-Type":"application/json;charset=UTF-8"}})}function Z(t){return Object(i["a"])({url:"projectTask/setProjectChildTask",method:"post",data:t,headers:{"Content-Type":"application/json;charset=UTF-8"}})}function tt(t){return Object(i["a"])({url:"projectTask/setProgress",method:"post",data:t,headers:{"Content-Type":"application/json;charset=UTF-8"}})}function et(t){return Object(i["a"])({url:"projectTask/setEstimatedManHours",method:"post",data:t,headers:{"Content-Type":"application/json;charset=UTF-8"}})}function at(t){return Object(i["a"])({url:"workTask/addWorkChildTask",method:"post",data:t,headers:{"Content-Type":"application/json;charset=UTF-8"}})}function it(t){return Object(i["a"])({url:"workTask/updateWorkChildTask",method:"post",data:t,headers:{"Content-Type":"application/json;charset=UTF-8"}})}function nt(t){return Object(i["a"])({url:"workTask/deleteWorkChildTask/".concat(t),method:"post"})}function st(t){return Object(i["a"])({url:"projectBoardTask/setTaskStatus",method:"post",data:t})}function ot(t){return Object(i["a"])({url:"projectTask/getProjectByTime",method:"post",data:t,headers:{"Content-Type":"application/json;charset=UTF-8"}})}function rt(t){return Object(i["a"])({url:"projectTask/getTaskByTime",method:"post",data:t,headers:{"Content-Type":"application/json;charset=UTF-8"}})}function ct(t){return Object(i["a"])({url:"projectTask/getTaskBurnout",method:"post",data:t,headers:{"Content-Type":"application/json;charset=UTF-8"}})}function lt(t){return Object(i["a"])({url:"projectTask/getProjectTaskEvent",method:"post",data:t,headers:{"Content-Type":"application/json;charset=UTF-8"}})}function dt(t){return Object(i["a"])({url:"projectTask/relevancyRelatedDemand",method:"post",data:t,headers:{"Content-Type":"application/json;charset=UTF-8"}})}function ut(t){return Object(i["a"])({url:"projectTask/setProjectChildTaskStatus",method:"post",data:t,headers:{"Content-Type":"application/json;charset=UTF-8"}})}function pt(t){return Object(i["a"])({url:"projectTask/downloadExcel",method:"post",data:t,responseType:"blob"})}function ht(t){var e=new FormData;return Object.keys(t).forEach((function(a){e.append(a,t[a])})),Object(i["a"])({url:"projectTask/excelImport",method:"post",data:e,headers:{"Content-Type":"multipart/form-data"},timeout:6e4})}function mt(t){return Object(i["a"])({url:"projectTask/downloadErrorExcel",method:"post",data:t,responseType:"blob"})}function ft(t){return Object(i["a"])({url:"projectTask/projectTaskExportColumn",method:"post",data:t})}function bt(t){return Object(i["a"])({url:"projectTask/projectTaskExport",method:"post",data:t,responseType:"blob",headers:{"Content-Type":"application/json;charset=UTF-8"}})}function gt(t){return Object(i["a"])({url:"projectTaskUser/relatedProjectTaskUser",method:"post",headers:{"Content-Type":"application/json;charset=UTF-8"},data:t})}function vt(t){return Object(i["a"])({url:"projectTask/sort/backlog",method:"post",headers:{"Content-Type":"application/json;charset=UTF-8"},data:t})}function kt(t){return Object(i["a"])({url:"projectTask/queryUserTaskCount",method:"post",headers:{"Content-Type":"application/json;charset=UTF-8"},data:t})}},"1c59":function(t,e,a){"use strict";var i=a("6d61"),n=a("6566");i("Set",(function(t){return function(){return t(this,arguments.length?arguments[0]:void 0)}}),n)},"1e6d":function(t,e,a){"use strict";a("cf90")},"212b":function(t,e,a){},"25f6":function(t,e,a){"use strict";a("4c91")},2796:function(t,e,a){"use strict";a("4d91")},"2a91":function(t,e,a){"use strict";a("71fa")},"397a":function(t,e,a){},4042:function(t,e,a){"use strict";a("d3b7"),a("159b"),a("caad");var i=a("6bfe");e["a"]={methods:{getAdvancedFilterOptionName:function(t,e){var a="date"===e||"datetime"===e;return{1:"等于",2:"不等于",3:"包含",4:"不包含",5:"为空",6:"不为空",7:a?"晚于":"大于",8:a?"不早于":"大于等于",9:a?"早于":"小于",10:a?"不晚于":"小于等于",12:"开始于",13:"结束于",14:a?"等于（时间段）":"等于（范围）"}[t]||""},getAdvancedFilterOptions:function(t,e){return"text"==t||"textarea"==t||"website"==t||"mobile"==t||"email"==t||"module"==t||"serial_number"==t?[{value:"is",label:"等于",disabled:!1,type:1},{value:"isNot",label:"不等于",disabled:!1,type:2},{value:"contains",label:"包含",disabled:!1,type:3},{value:"notContains",label:"不包含",disabled:!1,type:4},{value:"startWith",label:"开始于",disabled:!1,type:12},{value:"endWith",label:"结束于",disabled:!1,type:13},{value:"isNull",label:"为空",disabled:!1,type:5},{value:"isNotNull",label:"不为空",disabled:!1,type:6}]:"invoiceStatus"===e||"checkStatus"==t||"dealStatus"==t||"status"==t?[{value:"is",label:"等于",disabled:!1,type:1},{value:"isNot",label:"不等于",disabled:!1,type:2}]:"select"==t||"field_attention"==t?[{value:"is",label:"等于",disabled:!1,type:1},{value:"isNot",label:"不等于",disabled:!1,type:2},{value:"isNull",label:"为空",disabled:!1,type:5},{value:"isNotNull",label:"不为空",disabled:!1,type:6}]:"boolean_value"==t?[{value:"is",label:"等于",disabled:!1,type:1},{value:"isNot",label:"不等于",disabled:!1,type:2}]:"checkbox"==t||"location"==t?[{value:"is",label:"等于",disabled:!1,type:1},{value:"isNot",label:"不等于",disabled:!1,type:2},{value:"contains",label:"包含",disabled:!1,type:3},{value:"notContains",label:"不包含",disabled:!1,type:4},{value:"isNull",label:"为空",disabled:!1,type:5},{value:"isNotNull",label:"不为空",disabled:!1,type:6}]:"number"==t||"floatnumber"==t||"percent"==t?[{value:"is",label:"等于",disabled:!1,type:1},{value:"isNot",label:"不等于",disabled:!1,type:2},{value:"gt",label:"大于",disabled:!1,type:7},{value:"egt",label:"大于等于",disabled:!1,type:8},{value:"lt",label:"小于",disabled:!1,type:9},{value:"elt",label:"小于等于",disabled:!1,type:10},{value:"range",label:"等于（范围）",disabled:!1,type:14},{value:"isNull",label:"为空",disabled:!1,type:5},{value:"isNotNull",label:"不为空",disabled:!1,type:6}]:"date"==t||"datetime"==t?[{value:"is",label:"等于",disabled:!1,type:1},{value:"isNot",label:"不等于",disabled:!1,type:2},{value:"lt",label:"早于",disabled:!1,type:9},{value:"gt",label:"晚于",disabled:!1,type:7},{value:"egt",label:"不早于",disabled:!1,type:8},{value:"elt",label:"不晚于",disabled:!1,type:10},{value:"range",label:"等于（时间段）",disabled:!1,type:14},{value:"isNull",label:"为空",disabled:!1,type:5},{value:"isNotNull",label:"不为空",disabled:!1,type:6}]:"date_interval"==t||"position"==t?[]:"user"==t||"structure"==t||"single_user"==t||"field_tag"==t?[{value:"contains",label:"包含",disabled:!1,type:3},{value:"notContains",label:"不包含",disabled:!1,type:4},{value:"isNull",label:"为空",disabled:!1,type:5},{value:"isNotNull",label:"不为空",disabled:!1,type:6}]:[]},getAdvancedFilterDefaultItemByFormType:function(t,e,a){e||(e=t),"business_cause"==t.formType?(t.typeOption=e.setting,t.settingList=[],t.flowName="",t.settingName="",t.value=""):"checkStatus"==t.formType||"dealStatus"==t.formType||"invoiceStatus"==t.formType||"receivedStatus"==t.formType?(t.setting=e.setting||[],t.value=""):"map_address"==t.formType?t.address={state:"",city:"",area:""}:"user"===t.formType||"single_user"===t.formType||"structure"===t.formType||"category"===t.formType||"position"===t.formType?t.value=[]:"date"===t.formType||"datetime"===t.formType?(t.value="",this.$set(t,"timeType",""),this.$set(t,"timeTypeName",""),this.$set(t,"range",[])):"select"==t.formType||"checkbox"===t.formType||"field_attention"===t.formType?(t.setting=e.setting||[],t.value=[]):"number"==t.formType||"floatnumber"==t.formType||"percent"==t.formType?(t.min="",t.max="",t.value=""):"field_tag"===t.formType?(t.setting=e.setting||[],t.value=""):t.value="";var i=this.getAdvancedFilterOptions(a?a(t):t.formType,t.fieldName);if(i.length>0){var n=i[0];t.condition=n.value,t.type=n.type}else t.condition="is",t.type=1;return t},resetAdvancedFilterFieldsValue:function(t){t.forEach((function(t){"number"==t.formType||"floatnumber"==t.formType||"percent"==t.formType?(t.min="",t.max="",t.value=""):"business_cause"==t.formType?(t.flowName="",t.settingName="",t.value="",t.settingList=[]):"map_address"==t.formType?t.address={state:"",city:"",area:""}:["date","datetime"].includes(t.formType)?(t.value="",t.range=[]):Object(i["a"])(t.value)?t.value=[]:Object(i["c"])(t.value)?t.value={}:t.value=""}))}}}},4213:function(t,e,a){"use strict";a("212b")},"432b":function(t,e,a){"use strict";a("397a")},"4c91":function(t,e,a){},"4d91":function(t,e,a){},"4fad":function(t,e,a){var i=a("d039"),n=a("861d"),s=a("c6b6"),o=a("d86b"),r=Object.isExtensible,c=i((function(){r(1)}));t.exports=c||o?function(t){return!!n(t)&&((!o||"ArrayBuffer"!=s(t))&&(!r||r(t)))}:r},"50cf":function(t,e,a){"use strict";a("8f79")},"5a4a":function(t,e,a){"use strict";a("041c")},6062:function(t,e,a){a("1c59")},6566:function(t,e,a){"use strict";var i=a("9bf2").f,n=a("7c73"),s=a("6964"),o=a("0366"),r=a("19aa"),c=a("7234"),l=a("2266"),d=a("c6d2"),u=a("4754"),p=a("2626"),h=a("83ab"),m=a("f183").fastKey,f=a("69f3"),b=f.set,g=f.getterFor;t.exports={getConstructor:function(t,e,a,d){var u=t((function(t,i){r(t,p),b(t,{type:e,index:n(null),first:void 0,last:void 0,size:0}),h||(t.size=0),c(i)||l(i,t[d],{that:t,AS_ENTRIES:a})})),p=u.prototype,f=g(e),v=function(t,e,a){var i,n,s=f(t),o=k(t,e);return o?o.value=a:(s.last=o={index:n=m(e,!0),key:e,value:a,previous:i=s.last,next:void 0,removed:!1},s.first||(s.first=o),i&&(i.next=o),h?s.size++:t.size++,"F"!==n&&(s.index[n]=o)),t},k=function(t,e){var a,i=f(t),n=m(e);if("F"!==n)return i.index[n];for(a=i.first;a;a=a.next)if(a.key==e)return a};return s(p,{clear:function(){var t=this,e=f(t),a=e.index,i=e.first;while(i)i.removed=!0,i.previous&&(i.previous=i.previous.next=void 0),delete a[i.index],i=i.next;e.first=e.last=void 0,h?e.size=0:t.size=0},delete:function(t){var e=this,a=f(e),i=k(e,t);if(i){var n=i.next,s=i.previous;delete a.index[i.index],i.removed=!0,s&&(s.next=n),n&&(n.previous=s),a.first==i&&(a.first=n),a.last==i&&(a.last=s),h?a.size--:e.size--}return!!i},forEach:function(t){var e,a=f(this),i=o(t,arguments.length>1?arguments[1]:void 0);while(e=e?e.next:a.first){i(e.value,e.key,this);while(e&&e.removed)e=e.previous}},has:function(t){return!!k(this,t)}}),s(p,a?{get:function(t){var e=k(this,t);return e&&e.value},set:function(t,e){return v(this,0===t?0:t,e)}}:{add:function(t){return v(this,t=0===t?0:t,t)}}),h&&i(p,"size",{get:function(){return f(this).size}}),u},setStrong:function(t,e,a){var i=e+" Iterator",n=g(e),s=g(i);d(t,e,(function(t,e){b(this,{type:i,target:t,state:n(t),kind:e,last:void 0})}),(function(){var t=s(this),e=t.kind,a=t.last;while(a&&a.removed)a=a.previous;return t.target&&(t.last=a=a?a.next:t.state.first)?u("keys"==e?a.key:"values"==e?a.value:[a.key,a.value],!1):(t.target=void 0,u(void 0,!0))}),a?"entries":"values",!a,!0),p(e)}}},6894:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAACXBIWXMAABYlAAAWJQFJUiTwAAAFAklEQVR4nO2bT0wUVxzHP7sQFljAEv4EOehJxaagtNaFSJomstaakIaQkkgltmnTepJD02vVc1NTbvZgWku1CQkhjYlR4dADCeA/WiBA483DSgSLCusCgaWH326K23nDvNnZWWH5JJuQfcPvfee7M2/e/H7veVjH2kwoG2gH2oB3gGK2BnPAfeAa0OUpq1yJN3jif6zNhKqAHuBN1+W5ywTQ4imrnIKYAbGTHwTeSJ8uV3kG1HvKKqc8scv+L7b+L5/IBHDAi9zzmXbyIOfc7kUGvEylzbM2E/qHrTPa6zLnJXNPHqDYm24F6SbjDch2vcfFl/AkBAvPYWlRvvPlQsEOKK+E3HxX5aTegOUlGLsDUyPyeTptfnxJBVTVyqf6MOT4UirPszYTWktJ5NnH0N8Lw/2wFLEXw5cHgUZobIbSnc7qi+G8AeF5uN4FAzcguupMTG8WNJyApnbwFzoTM4azBowOw6+dsDDnWMhXKCiGUx1QE3AspDMGRKPw+xXo63ZAkgWCrfDRafAm/xBL3oDVFbjyPdz7I2kxWhx6H05/DVnJjePJ/Xc0av3ks3OgOgD7a2H3Xigph/zY/RwJw+w0PHoIkyMwOgQry+bx4n1++k1SV0JyV0DvTxtf9v4iONoC73343wlvRCQMAzfhdjeEX5gfG2yF5s+sxTXAvgGjw3DpvPkxgSC0fAEFRba6IDwPPZdh6Jb5cWfO2x4Y7RkQnocLX6lHe48H2s7CkeO2RP2PwT642ql+rBYUw7kfbT0i7d0817vMT/7Lb507eYD6IJw5J/MBIxbmRJMN9A2YfSyTHBVtZ+FAnS0xprz1LnzSoW4fuCHaNNE3oL9XfSkGgs7+8onUB6HuA+O26Kpo00TPgOUlmdsb4S+SAS/VtHwufRkx3C8aNdAzYOyO+sXmaIv90V4HfyEcazVuW4qIRg30DJgaMf4+O0ee827RcFz6NGLygVYoZwyoDlif5DhBnh9qFAPt339qhbJuwOJLdTJjf61Wp46g6vPptGi1iHUDnoTUbbv3Wg7jGLv2qNvMtCZg3YCF5+q2knLLYRyjtELdZqY1AesGxBOYRrh5/8fJ86vbzLQmkPFpcesG+HLVbZGwA1I0MevTTGsC1g0o2KFum90g1Z0KzPo005qAdQPKK9Vtjx5aDuMYZn2aaU3AugG5+VK0MGJSMUFKJao+Syq0qkt6g2CVYvIxOuTuOBAJS59G7DuoFcoZA1aWJYfnFgM31UnT/W9rhdIzoPqwlKuMuN0tqbJUE56Xvozw5YlGDfQMyPFJrc5Q2AtJYKaansvqTHGgUbuYqj8RamxW5+aGbkkCM1UM9qkzxN4s0aaJvgGlO6VQqeJqJ4zf1Q67IeN3JbaKhhO2Ksj2psJN7ZKKNiK6CpcuOHslDPZJTLO0eFO7rdD2DPAXSpVWRXQVui7CLz8kNzCG5yVG10XzUvupDttlc3dKY8daJY1l9ga3nk1RGgMpjv78nfXiaE2dZHJ27ZH3+bghdoqjIBXitBZHYdOXx7cXSGwvkdleJLW9TC41BsSJL5ScfCBFCysLJfcdlLe6Tb1QUsVrtlTWfQNeM7bT4ukWkG68yKbCTGXOC9xLt4o0ct8L/JZuFWnkWnzj5BhQlW41LiMbJ2MbiT8GNnjx3lI8Q/YPr3gBPGWV48ARYCqdqlxigti+YVi3exxe2T5/EjjE1tlTqNw+/y9M0diegvOS1gAAAABJRU5ErkJggg=="},"6d61":function(t,e,a){"use strict";var i=a("23e7"),n=a("da84"),s=a("e330"),o=a("94ca"),r=a("cb2d"),c=a("f183"),l=a("2266"),d=a("19aa"),u=a("1626"),p=a("7234"),h=a("861d"),m=a("d039"),f=a("1c7e"),b=a("d44e"),g=a("7156");t.exports=function(t,e,a){var v=-1!==t.indexOf("Map"),k=-1!==t.indexOf("Weak"),y=v?"set":"add",T=n[t],w=T&&T.prototype,C=T,j={},_=function(t){var e=s(w[t]);r(w,t,"add"==t?function(t){return e(this,0===t?0:t),this}:"delete"==t?function(t){return!(k&&!h(t))&&e(this,0===t?0:t)}:"get"==t?function(t){return k&&!h(t)?void 0:e(this,0===t?0:t)}:"has"==t?function(t){return!(k&&!h(t))&&e(this,0===t?0:t)}:function(t,a){return e(this,0===t?0:t,a),this})},I=o(t,!u(T)||!(k||w.forEach&&!m((function(){(new T).entries().next()}))));if(I)C=a.getConstructor(e,t,v,y),c.enable();else if(o(t,!0)){var D=new C,x=D[y](k?{}:-0,1)!=D,L=m((function(){D.has(1)})),O=f((function(t){new T(t)})),S=!k&&m((function(){var t=new T,e=5;while(e--)t[y](e,e);return!t.has(-0)}));O||(C=e((function(t,e){d(t,w);var a=g(new T,t,C);return p(e)||l(e,a[y],{that:a,AS_ENTRIES:v}),a})),C.prototype=w,w.constructor=C),(L||S)&&(_("delete"),_("has"),v&&_("get")),(S||x)&&_(y),k&&w.clear&&delete w.clear}return j[t]=C,i({global:!0,constructor:!0,forced:C!=T},j),b(C,t),k||a.setStrong(C,t,v),C}},7078:function(t,e,a){"use strict";a.d(e,"b",(function(){return n})),a.d(e,"a",(function(){return s}));a("d3b7"),a("159b"),a("b64b");var i=a("b775");function n(t){return Object(i["a"])({url:"hrmEmployee/queryInEmployeeList",method:"post",data:t,headers:{"Content-Type":"application/json;charset=UTF-8"}})}function s(t){return Object(i["a"])({url:"hrmEmployee/queryDeptEmployeeList/".concat(t),method:"post"})}},7195:function(t,e,a){"use strict";a.d(e,"b",(function(){return n})),a.d(e,"a",(function(){return s}));var i=a("b775");function n(t){return Object(i["a"])({url:"/hrmEmployee/queryInspectionDeptEmployeeList/".concat(t),method:"post",data:t})}function s(t){return Object(i["a"])({url:"hrmEmployee/queryInspectionAllEmployeeList",method:"post",data:t})}},"71fa":function(t,e,a){},"77bc":function(t,e,a){"use strict";a("0cd3")},8067:function(t,e,a){},"83b3":function(t,e,a){"use strict";a("0492")},86906:function(t,e,a){"use strict";a("b07b")},8917:function(t,e,a){"use strict";a.d(e,"a",(function(){return n}));var i=a("b775");function n(t){return Object(i["a"])({url:"jxcProductType/queryJxcProductType",method:"post",data:t})}},"8f79":function(t,e,a){},"94dd":function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAACXBIWXMAABYlAAAWJQFJUiTwAAAELklEQVR4nO2bTWwbRRiGn93sOnY3TeLEdV27KVB+FJWKklIQpQogAQdQDygIAUEBDqWnSpwQ4siVnpCQkCouKCItSCAuXBBIoABVEakKrSILVNQUYpI0sZ0Ex4l3Y3NwIoXu2jOo8Y5k73OKZr/NvPPueMb+Zj+NLWTsigGMAMPAA0CU5iAHTABjwGjS1JzNC9rmHxm70g98BhzwXZ6/TALPJU0tDRsGbAz+PNCtTpev5IGjSVNLaxvT/hea/8nfzCRwSKf6mW+1wUN1zCM61QWvVRnWMnYlS/Os9v+XnJaxKxXVKlSiqxagmsAA1QJUExigWoBqDNnAcqXC97PLXMwVWbbXiYdNjsUsDvbsaKS+hiO1Dc6slHj71wxfFUqua6/v6uCtexNE2mpPpqJT5svpPBcWCuSd8q0pFhAz23g03sFTe7owdE0YLzRgxSnzyoUpzq/aNWNOxCzeOZTyvJZdczg18RffFd3mNZKhrjDvDuyt+2BAYg344nqu7uABPpwvcGlhxfPae+lZ3wcP8PniKh9dnRfGCQ34Zm5ZqsPxG+643JrDx/MFqfsbwWhmibLgAy40IL3qiEIA+NtjlswUbYpSdzeGa+tlcqX6s1doQMJok+qsy3THdXq0+UkE6DTrb3RCAx7piUh1djjq3g6TVognrZDU/Y1guNfCFOwEQgNevC1KXPBPBiMGjyc6Xe0a8OY9cXo18Xa03ew3dE7eHRPGCQ1IWe28fyBR04SBkMHp+1I1nT7Ys4NPD/fxQrfcTLpVDK26LZ870sdeq10YL50P+POfNcamsoxni1y2HR5sN3lmdwdD+6J0h+S+UNrlCoslh0ZlIHQNukKG1BegTYKEiGoBqgkMUC1ANYEBqgWoJjBAtQDVBAaoFqCawADVAlQTGKBagGoCA1QLUI300djNCZGHwgZPx3e2RkLkh9llTk3OMOeRZB8IGXwwkKKvo3b6KZ1f5czVG3ySb3yS3NDgtV6Lk3fFSG1HSmy6sMbxn657Dn6TwYjB6MN3eOYFr2RXGL40zYLPiaf9hs5ZibygcA04N5WrO3iA8aLDtzNLrvYKcPq3Od8HD/CHU+bM79twNPZjVm7aXsy5zwYzhRJfe5wo+8XYQgFb8PCEBsw461KdLdruuCWPNj8pAkt2/aM9oQH9YbkVfk/YdLUlIib+nAZ4c3ubTjTk1rUVoQFPxHdKdTa4yx0XbTd4OWZJ3d8IRpKdiHZEoQHP7oty1OPpbuVEzOL+Xu9XZd7o381jEf/PB4e6wrx6p/hoLHhFRvZkqKVfkmpmWv7HUGCAagGqCQxQLUA1OtWiwlYlpwM/q1ahkAkdOKtahULGNgsnLwP9qtX4TLVwcqOQ+HnAndJpXvJU64cdHSBpaleAY0BapSqfmGSjbhi2VI/Df8rnXwKO0DwFlTXL5/8FYO93uLXgnbwAAAAASUVORK5CYII="},"9dba":function(t,e,a){"use strict";e["a"]={watch:{loading:function(t){if(t){var e=this.$refs.wkDialog.$refs.dialog;this.loadingInstance=this.$loading({target:e})}else this.loadingInstance&&this.loadingInstance.close()}}}},a123:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAACXBIWXMAABYlAAAWJQFJUiTwAAADMUlEQVR4nO2bzUsUcRjHPzOz7ri+bbvK6q6WYWqrLmmaZIRQh/CgBOEbWdob2BsUEfTf1KFIQYgIEgIPHbvkITLZDCwvHkTSOpgv+9Jh11LL1xnnKXc+p2VmeObzfPc3v4UdHoUVTE3GHUA30AXUAR72BjPAMNAHPPEFlMjyCWX5w9RkPAg8Ayot17OWUaDVF1DCkAwg2fwbYJ+cl6XMAid8ASWsJJf9O/b+N7+WUaBaJfHMp1rzkOi5WyWx4aUqXcrUZPwre2e33y4zKqnbPIBHlTaQxg5AWkAaOwBpAWlSPgCHWYUWF6JEo2ZV2xhNA6eumVLLcADzPyIMPP5IeGTaDJ8tEwzl0dlzGN1lrAXDj8DQ4ITlzQOER6YZGpwwXMdwABPj3wxLSN7bcADxeNywxE6JmXDvlP8VsAOQFpDGDkBaQBo7AGkBaewApAWksQOQFpDGDkBaQBo7AGkBaewApAWksQOQvLm/MAtfQaakgnnvBbZLTX0+5zrLiETh6cMPjI/NiHhYvgJUVaGlrYyOniBpuoYrQ+PKrRA19flWqwAWr4CsbCdd16o4eChn1XFNU2nvDuLJdfH61RcrlawLoLjETdfVSrLdzr+eVxQ401yMN1fnef8YsZg1f7dbEkBDYyHNrSVo2uZPXF1DAdlunf5HoyzMRza93ii7ugc40lTaLgY521G6peaXKa/w0Hu3hhy3vot2CXYtAI83nRv3jlJ7fGebm78ok5v3a/EXZZlstppdCaC0wsvtB3UE9huTd3uc9N6pprTCa5LZn5gewKmmYi5fD5GRac72orscXOoNUdfgN6XeWkzbBHVdo62ngqojuWaV/IXmUGi9UI43L52hl59/H9/GvrIehgNoaS1jbm4JfyATb166YaGNON10AI83nRcDn1hajNLQGDBcU5maFHy/vUNi0TixaByH8x9YARKomoKqKZtfuJVaplT5j7EDkBaQxg5AWkAaOwASQ4WpyowKvJW2EGRYBfqlLQTpWx6cfA8EpW0sJjE4mRwkbge+CwtZySyJ+eGICuALKCPASSAsaWURoyTnhmHF9DisGp8/Dxxj78wUrjs+/xOOj6LaJAENaQAAAABJRU5ErkJggg=="},b07b:function(t,e,a){},bb2f:function(t,e,a){var i=a("d039");t.exports=!i((function(){return Object.isExtensible(Object.preventExtensions({}))}))},cd5e:function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"pm-workbench"},[a("div",{staticClass:"pm-workbench-main"},[a("el-tabs",{attrs:{"nav-mode":"more"},on:{"tab-click":t.tabClick},model:{value:t.activeName,callback:function(e){t.activeName=e},expression:"activeName"}},t._l(t.tabList,(function(e,i){return a("el-tab-pane",{key:i,staticClass:"tab-item",attrs:{lazy:"",label:e.label,name:e.name}},[a("template",{slot:"label"},[a("el-badge",{attrs:{value:t.tabNum[e.name],hidden:t.tabNum[e.name]<=0,type:"primary"}},[a("span",[t._v(t._s(e.label))])])],1),t._v(" "),a("list-view",{ref:"list",refInFor:!0,attrs:{"item-type":e.name,"project-id":t.layout,"project-detail":t.projectDetail}})],2)}))),t._v(" "),a("div",{staticClass:"select-project"},[a("el-select",{staticStyle:{"margin-left":"12px"},on:{change:t.selectChanged},model:{value:t.layout,callback:function(e){t.layout=e},expression:"layout"}},[a("el-option-group",t._l(t.showList,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}},[a("i",{class:e.icon,staticStyle:{"margin-right":"5px"}}),t._v(t._s(e.label)+"\n          ")])})))],1)],1)],1)])},n=[],s=a("2909"),o=(a("d81d"),a("b0c0"),a("14d9"),a("1658")),r=a("a535"),c=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"common-list"},[a("wk-table-header",{attrs:{search:t.search,props:t.tableHeaderProps.props,"filter-header-props":t.tableHeaderProps.filterHeaderProps},on:{"update:search":function(e){t.search=e},"event-change":t.tableHeaderHandle}}),t._v(" "),a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}]},[a("table-list",{attrs:{list:t.list,"table-height":t.tableHeight,"row-height":t.rowHeight,"item-type":t.itemType,"project-detail":t.projectDetail},on:{"get-list":t.refreshList,handle:t.handleProcess}})],1),t._v(" "),a("div",{staticClass:"p-contianer"},[a("el-pagination",{staticClass:"p-bar",attrs:{"current-page":t.currentPage,"page-sizes":t.pageSizes,"page-size":t.pageSize,total:t.total,"pager-count":5,layout:"prev, pager, next, sizes, total, jumper"},on:{"update:pageSize":function(e){t.pageSize=e},"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1),t._v(" "),t.taskDetailShow?a("item-detail",{ref:"particulars",attrs:{id:t.taskId,"project-detail":t.projectDetail,"detail-index":t.detailIndex,"no-listener-class":["el-table__body"],"project-auth":t.projectAuth},on:{"update-list":t.handleUpdateList,close:t.detailClose}}):t._e()],1)},l=[],d=a("5530"),u=a("b85c"),p=(a("ac1f"),a("841c"),a("a15b"),a("d3b7"),a("159b"),a("5d2e")),h=a("eb71"),m=a("e605"),f=a("e297"),b=a.n(f),g=a("6651"),v={name:"List",components:{WkTableHeader:p["a"],TableList:h["a"],ItemDetail:m["default"]},inject:["rootTabs"],props:{itemType:String,projectDetail:Object,projectId:String},data:function(){return{loading:!1,list:[],tableHeight:200,rowHeight:49,search:"",filterList:[],currentPage:1,pageSize:b.a.get("crmPageSizes")||15,pageSizes:[15,30,60,100],total:0,tableHeaderProps:{props:{showFilterView:!1,showExportFields:!1},filterHeaderProps:{maxTabCount:0,tabSetShow:!1,searchPlaceholder:"搜索标题或ID"}},filterShow:!1,taskId:"",detailIndex:-1,taskDetailShow:!1,projectAuth:null}},computed:{},watch:{"rootTabs.currentName":function(t){t===this.itemType&&(this.filterList=[],this.getList())},projectId:{handler:function(t,e){e!=t&&this.rootTabs.currentName==this.itemType&&this.getList()}}},created:function(){},mounted:function(){var t=this;window.onresize=function(){t.updateTableHeight()},this.rootTabs.currentName==this.itemType&&(this.filterList=[],this.getList())},methods:{refreshList:function(){this.getList()},getFilterParams:function(){var t,e={},a=Object(u["a"])(this.filterList);try{for(a.s();!(t=a.n()).done;){var i,n=t.value,s=[],o=Object(u["a"])(n.list);try{for(o.s();!(i=o.n()).done;){var r=i.value;r.checked&&s.push(r.id)}}catch(c){o.e(c)}finally{o.f()}e[n.field]=s}}catch(c){a.e(c)}finally{a.f()}return e},getList:function(){var t=this;this.loading=!0;var e=Object(d["a"])({type:g["e"][this.itemType],projectId:"1"===this.projectId?"":this.projectId,name:this.search,page:this.currentPage,limit:this.pageSize},this.getFilterParams()),a=o["V"];"Iterations"==this.itemType&&(e.type=1,a=o["T"]),a(e).then((function(e){var a=e.data.list.map((function(t){return t.projectId})).join(",");Object(r["k"])({projectIds:a}).then((function(a){var i=a.data.map(g["d"]);t.list=e.data.list.map((function(t,e){return Object(d["a"])({taskAuth:i[e]},t)})),e.data.totalRow&&Math.ceil(e.data.totalRow/t.pageSize)<t.currentPage&&t.currentPage>1?(t.currentPage=t.currentPage-1,t.getList()):(t.total=e.data.totalRow,t.loading=!1),t.$nextTick((function(){document.querySelector(".el-table__body-wrapper").scrollTop=1})),t.updateTableHeight(),t.loading=!1})).catch((function(){t.loading=!1}))})).catch((function(){t.loading=!1}))},getObjIndex:function(t,e,a){for(var i=0;i<t.length;i++){var n=t[i];if(n[e]===a)return i}return null},handleProcess:function(t){var e=t.type,a=t.row;"detail"==e&&(this.taskId=a.taskId,this.projectAuth=a.taskAuth,this.detailIndex=this.getObjIndex(this.list,"taskId",a.taskId),this.taskDetailShow=!0)},handleUpdateList:function(){this.getList(),this.$bus.emit("update-workbench-num")},detailClose:function(){this.taskDetailShow=!1,this.getList()},tableHeaderHandle:function(t,e){"search"==t&&(this.search=e,this.getList())},handleSizeChange:function(t){b.a.set("crmPageSizes",t),this.pageSize=t,this.getList()},handleCurrentChange:function(t){this.currentPage=t,this.getList()},selectChanged:function(t){this.getList()},updateTableHeight:function(){var t=this,e=document.documentElement.clientHeight;this.$nextTick((function(){var a=t.getTableHead(),i=e-a.$el.clientHeight-226,n=t.rowHeight*t.list.length+51;t.tableHeight=n>i?i:0===t.list.length?200:n}))},getTableHead:function(){var t=null;return this.$children.forEach((function(e){e.$options&&"WkTableHeader"===e.$options.name&&(t=e)})),t},handleChange:function(t){this.filterList=t||[],this.getList()}}},k=v,y=(a("1e6d"),a("2877")),T=Object(y["a"])(k,c,l,!1,null,"7847942b",null),w=T.exports,C={name:"WorkbenchIndex",components:{ListView:w},data:function(){return{loading:!1,projectDetail:{type:3},activeName:"All",layout:"1",showList:[{label:"全部项目",value:"1"}],tabNum:{All:0,Require:0,Task:0,Defects:0,Iterations:0}}},computed:{tabList:function(){return[{label:"全部事项",name:"All"},{label:"需求",name:"Require"},{label:"任务",name:"Task"},{label:"缺陷",name:"Defects"},{label:"迭代",name:"Iterations"}]}},watch:{},created:function(){var t=this,e=this.$route.query.tab;e&&this.tabClick({name:e}),this.$store.commit("SET_PM_AUTH",null),this.getTabNum(),this.getProjectShowList(),this.$bus.on("update-workbench-num",(function(){t.getTabNum()}))},beforeDestroy:function(){this.$bus.off("update-workbench-num")},methods:{getTabNum:function(){var t=this;Object(o["rb"])().then((function(e){var a=e.data,i=a.all,n=a.need,s=a.task,o=a.defect,r=a.iteration;t.tabNum.All=i,t.tabNum.Require=n,t.tabNum.Task=s,t.tabNum.Defects=o,t.tabNum.Iterations=r})).catch((function(){}))},getProjectShowList:function(){var t=this;Object(r["p"])({pageType:0}).then((function(e){var a,i=e.data.list.map((function(t){return{label:t.name,value:t.projectId}}));(a=t.showList).push.apply(a,Object(s["a"])(i))}))},selectChanged:function(t){},tabClick:function(t){var e=t.name;this.$router.push({query:{tab:e}}),this.activeName=e}}},j=C,_=(a("83b3"),Object(y["a"])(j,i,n,!1,null,"7e960470",null));e["default"]=_.exports},cf90:function(t,e,a){},d86b:function(t,e,a){var i=a("d039");t.exports=i((function(){if("function"==typeof ArrayBuffer){var t=new ArrayBuffer(8);Object.isExtensible(t)&&Object.defineProperty(t,"a",{value:8})}}))},e04a:function(t,e,a){"use strict";a.d(e,"h",(function(){return n})),a.d(e,"k",(function(){return s})),a.d(e,"j",(function(){return o})),a.d(e,"i",(function(){return r})),a.d(e,"g",(function(){return c})),a.d(e,"d",(function(){return l})),a.d(e,"e",(function(){return d})),a.d(e,"f",(function(){return u})),a.d(e,"b",(function(){return p})),a.d(e,"c",(function(){return h})),a.d(e,"l",(function(){return m})),a.d(e,"a",(function(){return f})),a.d(e,"m",(function(){return b}));var i=a("b775");function n(t){return Object(i["a"])({url:"projectStatus/add",method:"post",headers:{"Content-Type":"application/json;charset=utf-8;"},data:t})}function s(t){return Object(i["a"])({url:"projectStatus/update",method:"post",headers:{"Content-Type":"application/json;charset=utf-8;"},data:t})}function o(t){return Object(i["a"])({url:"projectStatus/queryProjectStatusList",method:"post",headers:{"Content-Type":"application/json;charset=utf-8;"},data:t})}function r(t){return Object(i["a"])({url:"projectStatus/delete",method:"post",data:t})}function c(t){return Object(i["a"])({url:"projectEvent/queryEventList",method:"post",data:t})}function l(t){return Object(i["a"])({url:"projectEventStatus/add",method:"post",headers:{"Content-Type":"application/json;charset=utf-8;"},data:t})}function d(t){return Object(i["a"])({url:"projectEventStatus/remove",method:"post",data:t})}function u(t){return Object(i["a"])({url:"projectEventStatus/applicationSchemeStatusList",method:"post",data:t})}function p(t){return Object(i["a"])({url:"projectEventStatus/list",method:"post",data:t})}function h(t){return Object(i["a"])({url:"projectEventStatus/transferStatus",method:"post",headers:{"Content-Type":"application/json;charset=utf-8;"},data:t})}function m(t){return Object(i["a"])({url:"projectEventStatus/updateInitStatus",method:"post",data:t})}function f(t){return Object(i["a"])({url:"projectEventStatus/giveUpApplicationScheme",method:"post",data:t})}function b(t){return Object(i["a"])({url:"projectEventStatus/updateSorting",method:"post",headers:{"Content-Type":"application/json;charset=utf-8;"},data:t})}},e17e:function(t,e,a){"use strict";a.d(e,"a",(function(){return n}));var i=a("b775");function n(t){return Object(i["a"])({url:"adminUser/queryDeptUserList/".concat(t),method:"post"})}},e605:function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("slide-view",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"},{name:"empty",rawName:"v-empty",value:!t.canShowDetail,expression:"!canShowDetail"}],ref:"sideView",staticClass:"d-view",attrs:{"no-listener-class":t.noListenerClass,"body-style":{padding:0,height:"100%"},"xs-empty-icon":"nopermission","xs-empty-text":"暂无权限"},on:{afterEnter:t.viewAfterEnter,close:t.hideView}},[i("div",{ref:"crmDetailMain",staticClass:"detail-main no-padding"},[t.taskData?i("flexbox",{staticClass:"d-container",attrs:{direction:"column",align:"stretch"}},[i("wk-detail-header",{staticClass:"detail-header",attrs:{subtitle:t.subTitle,"page-list":t.pageList,"icon-class":"wk wk-icon-task-line",dropdowns:t.handleAuthOperations},on:{command:t.headerRightClick}},[i("div",{staticClass:"icon-name",attrs:{slot:"title"},slot:"title"},[i("img",{staticClass:"item-pic",attrs:{src:t.getIconClass(t.taskData)}}),t._v(" "),t.showEditTitle&&t.editAuth?i("wk-edit-wrap",{staticClass:"edit-wrap",on:{save:t.saveItemTitle,cancel:function(e){t.showEditTitle=!1}}},[i("el-input",{attrs:{maxlength:"100","show-word-limit":""},model:{value:t.taskData.name,callback:function(e){t.$set(t.taskData,"name",e)},expression:"taskData.name"}})],1):i("el-tooltip",{attrs:{disabled:!t.title,content:t.title,effect:"dark",placement:"top-start"}},[i("span",{staticClass:"wk-detail-header-title",on:{click:function(e){t.showEditTitle=!0}}},[t._v(t._s(t.title))])])],1)]),t._v(" "),t.labelList?i("div",{staticClass:"label"},[i("tag-view",{staticClass:"tag-view",attrs:{value:t.tagLabelList,"max-length":1/0,wrap:"wrap"}},[i("div",{staticClass:"add-tag"},[i("tag-index",{attrs:{placement:"bottom-start","task-data":t.taskData}},[t.editAuth?i("el-button",{attrs:{slot:"editIndex",type:"icon",size:"small",icon:"wk wk-icon-label-solid"},slot:"editIndex"}):t._e()],1)],1)])],1):t._e(),t._v(" "),t.editAuth?i("wk-quick-create-bar",{attrs:{list:t.activityHandle},on:{command:t.quickCreateClick}}):t._e(),t._v(" "),i("div",{staticClass:"main"},[i("div",{staticClass:"main__left left-padding",style:{height:t.calcHeight+"px"}},[t.descShow||t.childShow||t.relationShow||t.fileShow?i("div",{staticStyle:{"margin-bottom":"32px"}},[t.descShow&&t.editAuth?i("div",{staticClass:"section is-header"},[i("div",{staticClass:"section__bd description",staticStyle:{"margin-top":"0",cursor:"auto"}},[t.editDesc?[i("tinymce",{ref:"editor",staticClass:"rich-txt",attrs:{height:200,init:{menubar:!1,toolbar_sticky:!0,statusbar:!1,contextmenu:"",content_style:"p { margin: 5px 0; line-height: 1.5;}",plugins:"paste",toolbar:"paste",paste_data_images:!0,automatic_uploads:t.autoUpload}},model:{value:t.addDescriptionTextarea,callback:function(e){t.addDescriptionTextarea=e},expression:"addDescriptionTextarea"}}),t._v(" "),i("div",{staticClass:"save-cancel"},[i("el-button",{directives:[{name:"debounce",rawName:"v-debounce",value:t.submiteDescription,expression:"submiteDescription"}],attrs:{type:"primary"}},[t._v("保存")]),t._v(" "),i("el-button",{nativeOn:{click:function(e){return t.cancelEditDesc(e)}}},[t._v("取消")])],1)]:[i("div",{staticClass:"html-wrap"},[i("div",{ref:"descWrap",class:["desc-box",t.expand?"full-content-style":"part-content-style"],domProps:{innerHTML:t._s(t.addDescriptionTextarea)},on:{click:t.previewImg}}),t._v(" "),320===t.htmlHeght?[t.expand?t._e():i("div",{staticClass:"desc-mask"}),t._v(" "),i("div",{staticClass:"toggle-btn",on:{click:function(e){t.expand=!t.expand}}},[i("i",{staticClass:"el-icon-arrow-down el-icon--right arrow",style:{transform:t.expand?"rotate(180deg)":"none"}}),t._v("\n                        "+t._s(t.expand?"收起描述":"展开描述")+"\n                      ")])]:t._e()],2)]],2)]):t._e(),t._v(" "),t.childShow?i("div",{staticClass:"section"},[i("div",{staticClass:"section__hd"},[i("span",[t._v("子工作项")]),t._v(" "),t.editAuth?i("span",{staticClass:"line"}):t._e(),t._v(" "),t.editAuth?i("i",{staticClass:"wk wk-l-plus section-add",staticStyle:{float:"right"},on:{click:function(e){t.addSubtasks=!1}}}):t._e()]),t._v(" "),i("div",{staticClass:"section__bd"},[t.taskData.taskId?i("div",[0===t.childTask.length&&t.addSubtasks?t._e():i("div",{staticClass:"sub-task-all"},[t._l(t.childTask,(function(e,n){return i("div",{key:n,staticClass:"sub-task"},[e.showEdit?i("sub-work-item",{attrs:{name:e.name,"sub-id":e.taskId,index:n},on:{save:t.handleSave,close:function(a){t.handleCloseSub(e)}}}):i("flexbox",{class:{"is-checked-background":e.checked},staticStyle:{padding:"14px"}},[i("div",{on:{click:function(t){t.stopPropagation()}}},[i("el-checkbox",{attrs:{disabled:!t.getPermission("setChildTaskStatus")},on:{change:function(a){t.subtasksCheckbox(e,a)}},model:{value:e.checked,callback:function(a){t.$set(e,"checked",a)},expression:"item.checked"}})],1),t._v(" "),i("img",{staticClass:"item-img",attrs:{src:a("02fe"),alt:""}}),t._v(" "),i("span",{staticClass:"sub-num"},[t._v("#"+t._s(e.num))]),t._v(" "),i("div",{staticClass:"sub-task__bd text-one-line",class:{"is-checked":e.checked}},[t._v("\n                          "+t._s(e.name)+"\n                        ")]),t._v(" "),e.stopTime?i("div",{staticClass:"bg-color task-bg-color",staticStyle:{"margin-left":"8px"}},[t._v(t._s(t._f("moment")(e.stopTime,"YYYY-MM-DD"))+" 截止")]):t._e(),t._v(" "),e.mainUser?i("xr-avatar",{staticClass:"user-img",attrs:{name:e.mainUser.realname,size:25,src:e.mainUser.img}}):t._e(),t._v(" "),i("div",{staticClass:"edit-del-dropdown"},[t.editAuth?i("el-dropdown",{attrs:{"hide-on-click":!1},on:{command:t.handleSubTask}},[i("span",{staticClass:"el-dropdown-link"},[i("i",{staticClass:"el-icon-more",staticStyle:{cursor:"pointer"}})]),t._v(" "),i("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[i("el-dropdown-item",{attrs:{command:{type:"update",data:e}}},[t.getPermission("updateChildTask")?i("span",[t._v("\n                                  编辑\n                                ")]):t._e()]),t._v(" "),i("el-dropdown-item",{attrs:{command:{type:"delete",data:e}}},[t.getPermission("deleteChildTask")?i("span",[t._v("\n                                  删除\n                                ")]):t._e()])],1)],1):t._e()],1)],1)],1)})),t._v(" "),t.addSubtasks?t._e():i("div",[i("sub-work-item",{on:{save:t.handleSave,close:function(e){t.addSubtasks=!0,t.console.log("4444")}}})],1)],2)]):t._e()])]):t._e(),t._v(" "),t.fileShow?i("div",{staticClass:"section"},[i("div",{staticClass:"section__hd "},[i("span",[t._v("附件")]),t._v(" "),t.editAuth?i("span",{staticClass:"line"}):t._e(),t._v(" "),t.getPermission("uploadTaskFile")?i("el-upload",{ref:"fileUpload",staticClass:"upload-file",staticStyle:{float:"right"},attrs:{"http-request":t.httpRequest,action:"https://jsonplaceholder.typicode.com/posts/",multiple:"","list-type":"picture"}},[t.editAuth?i("i",{staticClass:"wk wk-l-plus section-add",staticStyle:{float:"right"}}):t._e()]):t._e()],1),t._v(" "),i("div",{staticStyle:{"margin-top":"6px"}},[i("file-cell",{attrs:{"file-list":t.fileList,"module-id":t.id,"show-delete":t.getPermission("deleteTaskFile"),"is-exposed":!0},on:{delete:t.accessoryDeleteFun}})],1)]):t._e()]):t._e(),t._v(" "),i("div",{staticClass:"margin-top-base "},[i("div",{staticStyle:{"font-size":"18px","font-weight":"600",color:"#172b4d"}},[t._v("活动日志")]),t._v(" "),i("div",{staticClass:"activity-title"},[t._v("\n              显示：\n              "),t._l(t.tabs,(function(e,a){return i("el-button",{key:a,attrs:{type:e.value===t.tabValue?"selected":""},on:{click:function(a){t.tabValue=e.value}}},[t._v(t._s(e.label))])}))],2),t._v(" "),"comment"===t.tabValue?i("flexbox",{directives:[{name:"loading",rawName:"v-loading",value:t.commentsLoading,expression:"commentsLoading"}],staticClass:"comment-cells",attrs:{direction:"column",align:"stretch"}},[t.replyList&&t.replyList.length>0?i("comment-list",{ref:"comment_list",attrs:{props:t.commentListProps,list:t.replyList,"show-control":t.editAuth},on:{delete:t.deleteComment,"close-other-reply":function(e){t.$refs.f_reply.toggleFocus(!0)},"query-comment":t.getCommentList}}):t._e(),t._v(" "),i("flexbox",{staticClass:"reply-comment-wrap",attrs:{align:"stretch"}},[i("xr-avatar",{staticClass:"user-img",attrs:{name:t.userInfo.realname,size:32,src:t.userInfo.img}}),t._v(" "),i("reply-comment",{ref:"f_reply",on:{toggle:t.closeOtherReply,reply:t.handleReply}})],1)],1):"activity"===t.tabValue||"hours"===t.tabValue?i("div",{staticClass:"activity-cells"},[i("activity-list",{attrs:{list:t.activityList,"hours-list":t.hoursList,type:t.tabValue}})],1):t._e()],1)]),t._v(" "),i("div",{staticClass:"main__right right-padding",style:{height:t.calcHeight+"px"}},[i("el-dropdown",{staticClass:"dropdown-status-btn",attrs:{disabled:!t.getPermission("setTaskStatus")},on:{command:t.setItemStatus}},[i("div",[i("el-button",{style:{"background-color":t.statusColor.bgColor,color:t.statusColor.color}},[t._v("\n                "+t._s(t.taskData.boardStatusName||"未开始")+"\n                "),i("i",{staticClass:"el-icon-arrow-down el-icon--right"})])],1),t._v(" "),i("el-dropdown-menu",{staticClass:"dropdown-menu",style:{padding:0===t.allStatusList.length?"0px":"auto"},attrs:{slot:"dropdown"},slot:"dropdown"},t._l(t.allStatusList,(function(t,e){return i("el-dropdown-item",{key:e,attrs:{command:t.id}},[i("span",{staticStyle:{padding:"5px"}},[i("status-tag",{attrs:{type:t.statusType,"status-name":t.statusName}})],1)])})))],1),t._v(" "),i("wk-head-section",{attrs:{label:"基础信息"}},[i("div",{staticClass:"detail-form"},t._l(t.detailList,(function(e,a){return i("wk-section-item",{key:a,attrs:{label:e.label}},["belongIterationName"===e.field?i("flexbox",{staticClass:"head-btn"},[t.showSearchIteration?i("el-autocomplete",{directives:[{name:"clickoutside",rawName:"v-clickoutside",value:t.editChangeSave,expression:"editChangeSave"}],staticStyle:{width:"100%"},attrs:{"fetch-suggestions":t.querySearchAsync,placeholder:"请输入迭代名称"},on:{select:t.handleSelect},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.item;return["btn"==a.type?i("div",{staticStyle:{color:"#0052cc"}},[t._v(t._s(a.name))]):i("div",{staticClass:"name"},[t._v(t._s(a.name))])]}}]),model:{value:t.itemName,callback:function(e){t.itemName=e},expression:"itemName"}}):i("div",{staticClass:"head-btn__bd",on:{click:function(a){t.editOpen(e.field)}}},[t.taskData.belongIterationName?i("span",[t._v(t._s(t.taskData.belongIterationName))]):i("span",{staticClass:"head-btn__text",staticStyle:{"padding-left":"0"}},[t._v("点击更改所属迭代")])])],1):"item"==e.formType?i("div",{staticClass:"head-btn text-one-line"},[t.editingObj[e.field]?i("el-select",{directives:[{name:"clickoutside",rawName:"v-clickoutside",value:t.editChangeSave,expression:"editChangeSave"}],staticStyle:{width:"100%"},attrs:{filterable:"",remote:"",clearable:"","remote-method":t.getRelatedDemandData,loading:t.relatedDemandLoading},on:{focus:function(e){t.getRelatedDemandData("")},change:t.relatedDemandChange},model:{value:t.taskData[e.field],callback:function(a){t.$set(t.taskData,e.field,a)},expression:"taskData[item.field]"}},t._l(t.relatedDemandOptions,(function(t){return i("el-option",{key:t.taskId,attrs:{label:t.name,value:t.taskId}})}))):i("div",{staticClass:"head-btn__bd",on:{click:function(a){t.editOpen(e.field)}}},[i("span",{staticClass:"head-btn__text",staticStyle:{"padding-left":"0"}},[t._v(t._s(t.taskData.relatedDemandName||"点击更改关联需求"))])])],1):"wrongType"==e.formType?i("div",{staticClass:"head-btn text-one-line"},[t.editingObj[e.field]?i("el-select",{directives:[{name:"clickoutside",rawName:"v-clickoutside",value:t.editChangeSave,expression:"editChangeSave"}],staticStyle:{width:"100%"},attrs:{clearable:""},on:{change:t.wrongTypeChange},model:{value:t.taskData[e.field],callback:function(a){t.$set(t.taskData,e.field,a)},expression:"taskData[item.field]"}},t._l(t.wrongTypes,(function(t){return i("el-option",{key:t.key,attrs:{label:t.label,value:t.key}})}))):i("div",{staticClass:"head-btn__bd",on:{click:function(a){t.editOpen(e.field)}}},[i("span",{staticClass:"head-btn__text",staticStyle:{"padding-left":"0"}},[t._v(t._s(t.taskData.wrongType?t.wrongTypes.find((function(e){return e.key==t.taskData.wrongType})).label:"点击更改缺陷"))])])],1):t._e(),t._v(" "),"projectOwnerRoleList"===e.field?i("flexbox",{staticClass:"head-btn"},[i("div",{staticClass:"head-btn__bd",staticStyle:{"padding-top":"3px","white-space":"normal"}},[i("wk-user-select",{staticStyle:{width:"100%"},attrs:{disabled:!t.editAuth,request:t.ownerListRequest,params:t.ownerListParams,props:{isList:!!t.ownerListRequest}},on:{change:t.taskUserChange,"visible-change":t.setTaskUser},model:{value:t.projectOwnerRoleList,callback:function(e){t.projectOwnerRoleList=e},expression:"projectOwnerRoleList"}},[i("flexbox",{staticClass:"head-btn",attrs:{slot:"reference"},slot:"reference"},[t.projectOwnerRoleList.length?t.projectOwnerRoleList.length?i("div",{staticStyle:{display:"flex"},on:{click:function(t){t.stopPropagation()}}},[t._l(t.ownerUserShowList,(function(e,a){return i("span",{key:a,class:["owner-list",{"owner-list-fold":t.projectOwnerRoleList.length<5}]},[i("xr-avatar",{staticClass:"user-img",attrs:{id:e.userId,name:e.realname,size:24,src:e.img}})],1)})),t._v(" "),t.projectOwnerRoleList.length>5?i("el-dropdown",{attrs:{trigger:"click","hide-on-click":!1}},[i("el-button",{staticClass:"dropdown-btn owner-list-button"},[t._v("\n                              +"+t._s(t.projectOwnerRoleList.length-5)+"\n                            ")]),t._v(" "),i("el-dropdown-menu",{staticClass:"owner-list-dropdown",attrs:{slot:"dropdown"},slot:"dropdown"},t._l(t.ownerUserHideList,(function(e,a){return i("el-dropdown-item",{key:a,staticClass:"owner-list-dropdown-list"},[i("xr-avatar",{staticClass:"owner-list-dropdown-img",staticStyle:{"margin-right":"10px"},attrs:{id:e.userId,name:e.realname,size:24,src:e.img}}),t._v(" "),i("p",{staticClass:"owner-list-dropdown-text"},[t._v(t._s(e.realname)+" ")])],1)})))],1):t._e()],2):t._e():i("span",{staticClass:"head-btn__text",staticStyle:{"padding-left":"0"}},[t._v("\n                          "+t._s(t.editAuth?"点击选择团队成员":"--")+"\n                        ")])])],1)],1)]):"priority"===e.field?i("flexbox",{nativeOn:{click:function(e){t.priorityVisible=!0}}},[i("el-dropdown",{staticClass:"priority-box",attrs:{disabled:!t.getPermission("priority")},on:{command:t.changePriority}},[i("div",{staticClass:"priority-wrap"},[i("img",{staticClass:"priority-icon",attrs:{src:t.handlePriorityIcon(t.taskData.priority),alt:""}}),t._v("\n                      "+t._s(["无","低","中","高"][t.taskData.priority])+"\n                    ")]),t._v(" "),i("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},t._l(t.priorityList,(function(e,a){return i("el-dropdown-item",{key:a,attrs:{command:e.key}},[i("div",{staticClass:"priority-wrap"},[i("img",{staticClass:"priority-icon",attrs:{src:e.icon,alt:""}}),t._v(t._s(e.label)+"\n                        ")])])})))],1)],1):"estimatedManHours"===e.field?i("flexbox",{staticClass:"head-btn"},[i("span",{staticClass:"head-btn__bd"},[t.showEditWorkTime?i("wk-edit-wrap",{staticClass:"edit-wrap",on:{save:t.handleWorkTime,cancel:function(e){t.showEditWorkTime=!1}}},[i("el-input",{model:{value:t.taskData.estimatedManHours,callback:function(e){t.$set(t.taskData,"estimatedManHours",e)},expression:"taskData.estimatedManHours"}})],1):i("span",{on:{click:function(e){t.editAuth&&(t.showEditWorkTime=!0)}}},[t.taskData.estimatedManHours?i("span",[t._v(t._s(t.taskData.estimatedManHours)+"小时")]):i("span",{staticClass:"head-btn__text",staticStyle:{"padding-left":"0"}},[t._v(t._s(t.editAuth?"点击更改预估工时":"--"))])])],1)]):"progress"===e.field?i("flexbox",{staticClass:"head-btn"},[i("span",{staticClass:"head-btn__bd"},[i("div",{staticClass:"progress-wrap"},[i("el-progress",{attrs:{type:"circle","show-text":!1,width:28,"stroke-width":4,percentage:Number(t.taskData.progress||0)}}),t._v(" "),t.editProgress?i("wk-edit-wrap",{staticClass:"edit-wrap",staticStyle:{"margin-left":"5px"},on:{save:t.hideProgress,cancel:function(e){t.editProgress=!1}}},[i("el-input",{model:{value:t.taskData.progress,callback:function(e){t.$set(t.taskData,"progress",e)},expression:"taskData.progress"}})],1):i("span",{staticStyle:{"margin-left":"5px"},on:{click:function(e){t.editAuth&&(t.editProgress=!0)}}},[t._v("已完成"+t._s(t.taskData.progress||0)+"%")])],1)])]):"taskTimeList"===e.field?i("flexbox",{staticClass:"head-btn"},[i("span",{staticClass:"head-btn__bd"},[i("div",{staticClass:"record-wrap",on:{click:function(e){t.editAuth&&(t.workTimeShow=!0)}}},[i("div",{staticClass:"record-desc"},[i("span",[t._v("已记录"+t._s(t.workTimeRecord.actualHour||0)+"小时")]),t._v(" "),i("span",[t._v("剩余"+t._s(t.workTimeRecord.surplusHours||0)+"小时")])]),t._v(" "),i("el-progress",{attrs:{percentage:t.recordPercentage||0,"show-text":!1,color:"#409eff"}})],1)])]):"createUserName"===e.field?i("flexbox",{staticClass:"head-btn"},[i("span",{staticClass:"head-btn__bd",staticStyle:{"padding-top":"3px"}},[i("xr-avatar",{key:t.taskData.createUserId,attrs:{id:t.taskData.createUserId,size:26,name:t.taskData.createUserName,src:t.taskData.createUserImg}})],1)]):["updateTime","createTime"].includes(e.field)?i("flexbox",{staticClass:"head-btn"},[i("span",{staticClass:"head-btn__bd"},[t._v(t._s(t._f("moment")(t.taskData[e.field]||"--","YYYY年MM月DD日")))])]):"mainUser"===e.field?i("wk-user-select",{staticStyle:{width:"100%","margin-left":"8px"},attrs:{disabled:!t.editAuth,value:t.taskData.mainUserId,request:t.ownerListRequest,params:t.ownerListParams,props:{isList:!!t.ownerListRequest},radio:""},on:{change:t.mainUserChange}},[i("flexbox",{staticClass:"head-btn",attrs:{slot:"reference"},slot:"reference"},[t.taskData.mainUserId?i("xr-avatar",{staticClass:"user-img handle-user",attrs:{id:t.taskData.mainUserId,disabled:"",name:t.taskData.mainUserName,size:26,src:t.taskData.mainUserImg}}):i("span",{staticClass:"head-btn__text",staticStyle:{"padding-left":"0"}},[t._v("\n                      "+t._s(t.editAuth?"点击选择处理人":"--")+"\n                    ")]),t._v(" "),i("div",{staticClass:"head-btn__bd"},[t.taskData.mainUserId?i("div",{staticClass:"head-btn__bd--name",staticStyle:{"font-size":"14px"}},[t._v("\n                        "+t._s(t.taskData.mainUserName)+"\n                      ")]):t._e()]),t._v(" "),i("i",{directives:[{name:"show",rawName:"v-show",value:t.taskData.mainUserId&&t.editAuth,expression:"taskData.mainUserId && editAuth"}],staticClass:"el-icon-close head-btn__close",on:{click:function(e){e.stopPropagation(),t.submiteMainUser(null)}}})],1)],1):["startTime","stopTime"].includes(e.field)?i("flexbox",{staticClass:"head-btn"},[t.taskData[e.field]?t._e():i("span",{staticClass:"head-btn__text"},[t._v("\n                    "+t._s(t.editAuth?"startTime"==e.field?"点击选择开始时间":"点击选择截止时间":"--")+"\n                  ")]),t._v(" "),i("el-date-picker",{attrs:{disabled:!t.getPermission("setTaskTime",e.field),clearable:!1,"picker-options":"startTime"==e.field?t.startTimeOptions:t.stopTimeOptions,type:"date","value-format":"yyyy-MM-dd"},on:{change:function(a){t.timeChange(e.field)}},model:{value:t.taskData[e.field],callback:function(a){t.$set(t.taskData,e.field,a)},expression:"taskData[item.field]"}}),t._v(" "),i("div",{staticClass:"head-btn__bd"},[t.taskData[e.field]?i("div",{staticClass:"head-btn__bd--title",staticStyle:{"font-size":"14px"}},[t._v(t._s(t._f("moment")(t.taskData[e.field],"YYYY年MM月DD日")))]):t._e()]),t._v(" "),t.editAuth?i("i",{directives:[{name:"show",rawName:"v-show",value:t.taskData[e.field],expression:"taskData[item.field]"}],staticClass:"el-icon-close head-btn__close",on:{click:function(a){t.deleteTime(e.field)}}}):t._e()],1):t._e()],1)})))])],1)])],1):t._e()],1),t._v(" "),i("create-work-time",{attrs:{visible:t.workTimeShow,"task-data":t.taskData,"item-type":t.itemType,"rest-hours":t.workTimeRecord.surplusHours},on:{"update:visible":function(e){t.workTimeShow=e},"save-success":t.handleRefresh,close:function(e){t.workTimeShow=!1}}})],1)},n=[],s=a("2909"),o=a("b85c"),r=a("5530"),c=(a("a9e3"),a("b0c0"),a("99af"),a("4de4"),a("d3b7"),a("caad"),a("d81d"),a("14d9"),a("fb6a"),a("a4d3"),a("e01a"),a("2532"),a("159b"),a("7db0"),a("3ca3"),a("ddb0"),a("a434"),a("a535")),l=a("1658"),d=a("e04a"),u=a("130f"),p=a("da37"),h=a("8256"),m=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"create-box"},[t.subId?i("el-checkbox",{staticClass:"checked",attrs:{disabled:!0},model:{value:t.checked,callback:function(e){t.checked=e},expression:"checked"}}):t._e(),t._v(" "),i("img",{staticClass:"item-img",attrs:{src:a("02fe"),alt:""}}),t._v(" "),i("el-input",{ref:"subInput",staticClass:"input",attrs:{placeholder:"子工作项标题"},model:{value:t.title,callback:function(e){t.title=e},expression:"title"}}),t._v(" "),i("div",{staticClass:"btn-group"},[i("el-button",{directives:[{name:"debounce",rawName:"v-debounce",value:t.handleConfirm,expression:"handleConfirm"}],attrs:{type:"primary"}},[t._v("保存")]),t._v(" "),i("el-button",{nativeOn:{click:function(e){return t.handleClose(e)}}},[t._v("取消")])],1)],1)},f=[],b={name:"SubWorkItem",components:{},props:{name:String,index:Number,subId:[String,Number]},data:function(){return{checked:!1,title:""}},computed:{},watch:{},created:function(){this.name&&(this.title=this.name)},mounted:function(){this.$refs.subInput.focus()},methods:{handleClose:function(){this.$emit("close")},handleConfirm:function(){this.$emit("save",{type:this.name?"edit":"add",name:this.title,subId:this.subId,index:this.index}),this.name||(this.title="")}}},g=b,v=(a("1019"),a("2877")),k=Object(v["a"])(g,m,f,!1,null,"9cb5f662",null),y=k.exports,T=a("0f6f"),w=a("787c"),C=a("88c0"),j=a("5feb"),_=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-popover",{attrs:{placement:t.placement,width:t.popoverWidth,trigger:"click"},model:{value:t.tagShow,callback:function(e){t.tagShow=e},expression:"tagShow"}},[0==t.tagContent?a("div",{staticClass:"tag-popover-box"},[a("div",{staticClass:"tag-top"},[a("span",[t._v("选择标签")]),t._v(" "),a("span",{staticClass:"el-icon-close rt cursor-pointer",on:{click:function(e){t.tagShow=!1}}})]),t._v(" "),a("el-input",{attrs:{placeholder:"搜索标签","prefix-icon":"el-icon-search",size:"small"},model:{value:t.tagSearch,callback:function(e){t.tagSearch=e},expression:"tagSearch"}}),t._v(" "),a("div",{staticClass:"tag-content"},t._l(t.showTagList,(function(e,i){return a("div",{key:i,staticClass:"tag-list",on:{click:function(a){t.tagSelectClick(e,i)}}},[a("i",{staticClass:"wukong wukong-black-label",style:{color:e.color}}),t._v(" "),a("span",{staticClass:"item-label"},[t._v(t._s(e.name))]),t._v(" "),e.check?a("span",{staticClass:"el-icon-check rt"}):t._e()])}))),t._v(" "),a("div",{staticClass:"tag-footer"},[a("div",[a("el-button",{staticClass:"footer-row",attrs:{type:"text"},on:{click:t.createTagClick}},[t._v("+ 创建标签")])],1),t._v(" "),a("div",[a("el-button",{staticClass:"footer-row",attrs:{type:"text"},on:{click:t.managementTag}},[t._v("+ 管理标签")])],1)])],1):1==t.tagContent||3==t.tagContent?a("new-tag",{attrs:{"new-tag-title":t.newTagTitle,"new-tag-input":t.newTagInput,"bg-color-props":t.bgColorProps},on:{changeColor:t.changeColor,close:t.tagClose,tagCreateSubmit:t.tagCreateSubmit,tagCancel:t.tagCancel,back:t.back}}):2==t.tagContent?a("editTag",{attrs:{"edit-tag-list":t.tagList},on:{back:t.back,close:t.tagClose,editBtn:t.editTagClick,deleteBtn:t.deleteBtn}}):t._e(),t._v(" "),a("span",{attrs:{slot:"reference"},on:{click:t.referenceFun},slot:"reference"},[t._t("editIndex")],2)],1)},I=[],D=(a("a15b"),function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"new-tag-dialog"},[a("flexbox",{staticClass:"tag-dialog-header"},[a("div",{staticClass:"tag-dialog-header__text"},[a("span",{staticClass:"el-icon-arrow-left",on:{click:t.back}}),t._v("\n      "+t._s(t.newTagTitle)+"\n    ")]),t._v(" "),a("i",{staticClass:"el-icon-close icon-close",on:{click:t.close}})]),t._v(" "),a("div",{staticClass:"search"},[a("el-input",{attrs:{maxlength:10,placeholder:"输入标签名，最多十个字符"},model:{value:t.input,callback:function(e){t.input="string"===typeof e?e.trim():e},expression:"input"}}),t._v(" "),a("span",{staticClass:"checked-color",style:{background:t.showBgColor}})],1),t._v(" "),a("div",{staticClass:"color-box"},t._l(t.colorList,(function(e,i){return a("span",{key:i,style:{background:e},on:{click:function(a){t.changeColor(e)}}})}))),t._v(" "),a("div",{staticClass:"footer"},[a("el-button",{directives:[{name:"debounce",rawName:"v-debounce",value:t.tagCreateSubmit,expression:"tagCreateSubmit"}],attrs:{type:"primary"}},[t._v("保存")]),t._v(" "),a("el-button",{on:{click:t.tagCancel}},[t._v("取消")])],1)],1)}),x=[],L={props:{newTagTitle:String,newTagInput:String,bgColorProps:String},data:function(){return{colorList:["#0052CC","#00A3BF","#DE350B","#5243AA","#00875A","#FF991F","#091E42"],input:this.newTagInput,showBgColor:""}},watch:{bgColorProps:function(t){this.showBgColor=t||"#0052CC"}},mounted:function(){this.showBgColor=this.bgColorProps||"#0052CC"},methods:{back:function(){this.$emit("back")},close:function(){this.$emit("close")},changeColor:function(t){this.$emit("changeColor",t)},tagCreateSubmit:function(){this.input?this.$emit("tagCreateSubmit",this.input,this.showBgColor):this.$message.error("请输入标签名")},tagCancel:function(){this.$emit("tagCancel")}}},O=L,S=(a("432b"),Object(v["a"])(O,D,x,!1,null,"51135a51",null)),A=S.exports,N=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"edit-tag-dialog"},[a("flexbox",{staticClass:"tag-dialog-header"},[a("div",{staticClass:"tag-dialog-header__text"},[a("span",{staticClass:"el-icon-arrow-left",on:{click:t.back}}),t._v("\n      标签管理\n    ")]),t._v(" "),a("i",{staticClass:"el-icon-close icon-close",on:{click:t.close}})]),t._v(" "),a("div",{staticClass:"search"},[a("el-input",{attrs:{maxlength:10,placeholder:"输入标签名，最多十个字符"},model:{value:t.searchInput,callback:function(e){t.searchInput=e},expression:"searchInput"}})],1),t._v(" "),a("div",{staticClass:"content"},t._l(t.list,(function(e,i){return a("div",{key:i,staticClass:"tag-list"},[a("span",{staticClass:"tag-name",style:{background:e.color?e.color:"#ccc"}},[t._v("\n        "+t._s(e.name.length>10?e.name.substring(0,10)+"...":e.name)+"\n      ")]),t._v(" "),a("div",{staticClass:"rt"},[a("span",{staticClass:"el-icon-edit",on:{click:function(a){t.editBtn(e)}}}),t._v(" "),a("span",{staticClass:"el-icon-delete",on:{click:function(a){t.deleteBtn(e)}}})])])})))],1)},U=[],P={props:{editTagList:Array},data:function(){return{searchInput:""}},computed:{list:function(){var t=this;return this.editTagList.filter((function(e){return e.name.indexOf(t.searchInput)>-1}))}},watch:{},methods:{back:function(){this.$emit("back")},close:function(){this.$emit("close")},deleteBtn:function(t){this.$emit("deleteBtn",t)},editBtn:function(t){this.$emit("editBtn",t)}}},F=P,H=(a("50cf"),Object(v["a"])(F,N,U,!1,null,"24572cac",null)),E=H.exports,$={components:{NewTag:A,EditTag:E},props:{taskData:{type:Object,default:function(){return{}}},placement:String},data:function(){return{tagShow:!1,tagContent:0,tagSearch:"",tagList:[],newTagType:"create",newTagInput:"",bgColorProps:"",editTagId:""}},computed:{showTagList:function(){for(var t=[],e=0;e<this.tagList.length;e++){var a=this.tagList[e];a.name.indexOf(this.tagSearch)>-1&&t.push(a)}return t},popoverWidth:function(){return 1==this.tagContent?330:2==this.tagContent?400:220},newTagTitle:function(){return"create"===this.newTagType?"创建新标签":"编辑标签"}},watch:{},mounted:function(){},methods:{createTagClick:function(){this.newTagType="create",this.newTagInput="",this.tagContent=1},editTagClick:function(t){this.editTagId=t.labelId,this.newTagType="update",this.tagContent=1,this.bgColorProps=t.color,this.newTagInput=t.name},managementTag:function(){this.tagContent=2},tagSelectClick:function(t,e){var a=this;if(this.$listeners.change)t.check=!t.check,this.$emit("change",this.tagList.filter((function(t){return t.check})));else{this.tagList[e].check=!t.check;var i=this.tagList.filter((function(t){return t.check}));Object(l["J"])({taskId:this.taskData.taskId,ids:i.map((function(t){return t.labelId})).join(",")}).then((function(e){if(t.check){var i=[];a.tagList.forEach((function(t){t.check&&(t.labelName=t.name,i.push(t))})),a.taskData.labelTaskList=i}else a.updateDetailList(t,"delete")})).catch((function(){t.check=!0}))}},updateDetailList:function(t,e){if(this.taskData&&this.taskData.labelTaskList){for(var a=-1,i=0;i<this.taskData.labelTaskList.length;i++){var n=this.taskData.labelTaskList[i];if(n.labelId==t.labelId){a=i;break}}a>=0&&("delete"==e?this.taskData.labelTaskList.splice(a,1):this.taskData.labelTaskList.splice(a,1,t))}},changeColor:function(t){this.bgColorProps=t},tagClose:function(){this.tagShow=!1},tagCreateSubmit:function(t,e){var a=this;"create"==this.newTagType?Object(l["a"])({name:t,color:e}).then((function(t){a.getTagList(),a.back(),a.$message.success("创建成功")})):Object(l["M"])({name:t,labelId:this.editTagId,color:e}).then((function(i){var n,s=Object(o["a"])(a.tagList);try{for(s.s();!(n=s.n()).done;){var r=n.value;r.labelId==a.editTagId&&(r.name=t,r.color=e,r.labelName=r.name,a.updateDetailList(r,"update"))}}catch(c){s.e(c)}finally{s.f()}a.tagContent=2}))},tagCancel:function(){"create"==this.newTagType?(this.tagClose(),this.$message.info("已取消创建")):this.tagContent=2},back:function(){1==this.tagContent?this.tagContent="create"==this.newTagType?0:2:2==this.tagContent&&(this.tagContent=0)},deleteBtn:function(t){var e=this;this.$confirm("确定删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",customClass:"is-particulars"}).then((function(){Object(l["f"])({labelId:t.labelId}).then((function(a){for(var i in e.tagList)if(e.tagList[i].labelId==t.labelId){e.tagList.splice(i,1);break}e.$message({type:"success",message:"删除成功!"}),e.tagShow=!0})).catch((function(){e.tagShow=!0}))})).catch((function(){e.$message({type:"info",message:"已取消删除"}),e.tagShow=!0}))},getTagList:function(){var t=this;Object(l["w"])({name:""}).then((function(e){var a=e.data||[],i=[];t.tagList.length>0?i=t.tagList.filter((function(t){return t.check})).map((function(t){return t.labelId})):t.taskData&&t.taskData.labelTaskList&&(i=t.taskData.labelTaskList.map((function(t){return t.labelId})));var n,s=Object(o["a"])(a);try{for(s.s();!(n=s.n()).done;){var r=n.value;r.check=i.includes(r.labelId)}}catch(c){s.e(c)}finally{s.f()}t.tagList=a})).catch((function(){}))},referenceFun:function(){this.tagContent=0,this.tagList&&!this.tagList.length&&this.getTagList()}}},R=$,B=(a("5a4a"),Object(v["a"])(R,_,I,!1,null,"b0bb533a",null)),W=B.exports,q=a("02c0"),M=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{},[t.dialogVisible?a("el-dialog",{ref:"wkDialog",attrs:{"append-to-body":!0,"close-on-click-modal":!1,visible:t.dialogVisible,title:"添加工时",width:"800px","custom-class":"no-padding-dialog"},on:{"update:visible":function(e){t.dialogVisible=e},close:t.handleClose}},[a("div",{staticClass:"main"},[a("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:t.ruleForm,rules:t.rules,"label-width":"150px"}},t._l(t.fieldList,(function(e,i){return a("el-form-item",{key:i,style:{width:e.width},attrs:{label:e.label,prop:e.field}},["item"==e.type?a("el-autocomplete",{staticStyle:{width:"100%"},attrs:{disabled:e.disable,"fetch-suggestions":t.querySearchAsync,placeholder:e.placeholder},on:{select:t.handleSelect},scopedSlots:t._u([{key:"default",fn:function(e){var i=e.item;return[a("div",{staticClass:"name"},[t._v(t._s(i.name))])]}}]),model:{value:t.itemName,callback:function(e){t.itemName=e},expression:"itemName"}}):"user"==e.type?a("wk-user-select",{staticStyle:{width:"100%"},attrs:{disabled:e.disable,props:t.userSelectProps,radio:""},model:{value:t.ruleForm[e.field],callback:function(a){t.$set(t.ruleForm,e.field,a)},expression:"ruleForm[item.field]"}}):"date"==e.type?a("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date","value-format":"yyyy-MM-dd HH:mm",placeholder:e.placeholder},model:{value:t.ruleForm[e.field],callback:function(a){t.$set(t.ruleForm,e.field,a)},expression:"ruleForm[item.field]"}}):"textarea"==e.type?a("el-input",{attrs:{type:"textarea",placeholder:e.placeholder},model:{value:t.ruleForm[e.field],callback:function(a){t.$set(t.ruleForm,e.field,a)},expression:"ruleForm[item.field]"}}):"time"==e.type?a("el-input",{staticClass:"input-with-select",attrs:{placeholder:e.placeholder},on:{change:function(a){t.handleChange(a,e.field)}},model:{value:t.ruleForm[e.field],callback:function(a){t.$set(t.ruleForm,e.field,a)},expression:"ruleForm[item.field]"}},[a("el-button",{attrs:{slot:"append",type:"text"},slot:"append"},[t._v("小时")])],1):t._e()],1)}))),t._v(" "),a("div",{staticClass:"btn-wrap",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{directives:[{name:"debounce",rawName:"v-debounce",value:t.handleConfirm,expression:"handleConfirm"}],attrs:{type:"primary"}},[t._v("保存")]),t._v(" "),a("el-button",{nativeOn:{click:function(e){return t.handleClose(e)}}},[t._v("取消")])],1)],1)]):t._e()],1)},z=[],Y=a("5c0a"),V=a("9dba"),J=a("2f62"),G={name:"CreateWorkTime",components:{WkUserSelect:Y["a"]},mixins:[V["a"]],props:{visible:{type:Boolean,required:!0,default:!1},taskData:{type:Object,default:function(){return{}}},itemType:String,restHours:[String,Number]},data:function(){return{dialogVisible:!1,loading:!1,fieldList:[{type:"time",label:"实际投入时长",field:"actualHour",placeholder:"0",width:"48%"},{type:"time",label:"剩余工时",field:"surplusHours",placeholder:"0",width:"48%"}],ruleForm:{taskId:"",actualHour:"",surplusHours:""},rules:{actualHour:[{required:!0,message:"请输入实际投入时长",trigger:"blur"}]},selectedUserIds:[],selectUserList:[],currentItem:"",itemName:""}},computed:Object(r["a"])(Object(r["a"])({},Object(J["b"])(["userInfo"])),{},{userSelectProps:function(){return{request:c["u"],params:{projectId:this.$route.params.id},isList:!0}}}),watch:{visible:{handler:function(t){t&&this.taskData.taskId&&(this.itemName=this.taskData.name,this.ruleForm.taskId=this.taskData.taskId,this.fieldList[1].placeholder=this.restHours,this.ruleForm.actualHour="",this.ruleForm.surplusHours=""),this.dialogVisible=t},immediate:!0}},methods:{handleClose:function(){this.dialogVisible=!1,this.$emit("update:visible",!1),this.$emit("close")},handleChange:function(t,e){"actualHour"==e&&(!this.restHours||t>=this.restHours?this.fieldList[1].placeholder=0:this.fieldList[1].placeholder=this.restHours-t)},querySearchAsync:function(t,e){var a=this;if(t){var i={name:t,projectId:this.$route.params.id,type:"",pageType:0};Object(l["R"])(i).then((function(i){var n=i.data.list,s=t?n.filter(a.createStateFilter(t)):n;e(s)})).catch((function(){e([])}))}else e([])},createStateFilter:function(t){return function(e){return 0===e.name.toLowerCase().indexOf(t.toLowerCase())}},handleSelect:function(t){this.currentItem=t,this.itemName=t.name},handleConfirm:function(){var t=this;this.$refs.ruleForm.validate((function(e){if(e){t.loading=!0;var a=Object(r["a"])({companyId:t.userInfo.companyId},t.ruleForm);a.surplusHours=a.surplusHours||t.fieldList[1].placeholder,Object(l["b"])(a).then((function(e){t.$message.success("操作成功"),t.$emit("save-success"),t.loading=!1})).catch((function(){t.loading=!1}))}}))}}},K=G,X=(a("2796"),Object(v["a"])(K,M,z,!1,null,"070ca48c",null)),Q=X.exports,Z=a("1557"),tt=a("deea"),et=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"comment-list"},t._l(t.list,(function(e,i){return a("div",{key:i,staticClass:"comment-list-item"},[a("div",{staticClass:"parent-reply reply"},[a("div",{staticClass:"user-info"},[a("xr-avatar",{staticClass:"user-img",attrs:{id:e.user.userId,name:e.user.realname,size:32,src:e.user.img,disabled:!1}}),t._v(" "),a("div",{staticClass:"user-info__bd"},[a("span",{staticClass:"user"},[t._v(t._s(e.user.realname))]),t._v(" "),a("span",{staticClass:"time"},[t._v("\n            "+t._s(t._f("formatTime")(e.createTime))+"\n          ")])])],1),t._v(" "),a("div",{staticClass:"content"},[t._v(t._s(e.content))]),t._v(" "),a("div",{staticClass:"control"},[a("el-button",{staticClass:"reply-btn",attrs:{type:"text"},on:{click:function(e){t.handleToReply(i)}}},[a("i",{staticClass:"wk wk-icon-message-line"}),t._v("\n          回复\n        ")]),t._v(" "),a("el-button",{staticClass:"delete-btn",attrs:{type:"text"},on:{click:function(a){t.handleToDelete(e,i)}}},[a("i",{staticClass:"wk wk-icon-bin"}),t._v("\n          删除\n        ")])],1),t._v(" "),t.replyIndex===String(i)?a("reply-comment",{on:{reply:function(a){t.handleReply(a,e)},close:function(e){t.replyIndex=null}}}):t._e()],1),t._v(" "),e.childCommentList&&e.childCommentList.length>0?t._l(e.childCommentList,(function(e,n){return a("div",{key:n,staticClass:"child-reply-list"},[a("div",{staticClass:"child-reply reply"},[a("div",{staticClass:"user-info"},[a("xr-avatar",{staticClass:"user-img",attrs:{id:e.user.userId,name:e.user.realname,size:34,src:e.user.img,disabled:!1}}),t._v(" "),a("div",{staticClass:"user-info__bd"},[a("span",[t._v("\n                "+t._s(e.user.realname)+"\n              ")]),t._v(" "),a("span",{staticClass:"time"},[t._v("\n                "+t._s(e.createTime)+"\n              ")])])],1),t._v(" "),a("div",{staticClass:"child-content"},[a("span",[t._v("\n              回复 @"+t._s(e.replyUser.realname)+"：\n            ")]),t._v(" "),a("span",{staticClass:"content"},[t._v(t._s(e.content))])]),t._v(" "),a("div",{staticClass:"control"},[a("el-button",{staticClass:"reply-btn",attrs:{type:"text"},on:{click:function(e){t.handleToReply(i,n)}}},[a("i",{staticClass:"wk wk-icon-message-line"}),t._v("\n              回复\n            ")]),t._v(" "),a("el-button",{staticClass:"delete-btn",attrs:{type:"text"},on:{click:function(a){t.handleToDelete(e,i,n)}}},[a("i",{staticClass:"wk wk-icon-bin"}),t._v("\n              删除\n            ")])],1),t._v(" "),t.replyIndex===i+"-"+n?a("reply-comment",{directives:[{name:"loading",rawName:"v-loading",value:t.commentLoading,expression:"commentLoading"}],on:{reply:function(a){t.handleReply(a,e)},close:function(e){t.replyIndex=null}}}):t._e()],1)])})):t._e()],2)})))},at=[],it=a("74fc"),nt=a("5e38"),st=a.n(nt),ot=a("8ed6"),rt=a("ed08"),ct={addRequest:null,addParams:null,replyKey:"pid",replyValueKey:"userId",deleteRequest:null,deleteParams:null},lt={name:"CommentList",components:{ReplyComment:it["a"]},filters:{formatTime:function(t){return Object(rt["g"])(t)}},props:{props:{type:Object,default:function(){return{}}},list:{type:Array,required:!0},showControl:{type:Boolean,default:!0}},data:function(){return{replyIndex:null,commentLoading:!1}},computed:Object(r["a"])(Object(r["a"])({},Object(J["b"])(["userInfo"])),{},{config:function(){return Object(ot["a"])(Object(r["a"])({},ct),this.props||{})}}),methods:{handleToReply:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a="".concat(t).concat(null!==e?"-"+e:"");this.$emit("close-other-reply"),a!==this.replyIndex&&(this.replyIndex=a)},closeReply:function(){this.replyIndex=null},handleReply:function(t,e){var a=this,i={content:st()(t)},n=null,s=this.replyIndex.split("-"),o=this.list[s[0]];s[1]&&(n=o.childCommentList[s[1]]),o&&(i.mainId=o.commentId,i[this.config.replyKey]=this.getReplyValue(o,this.config.replyValueKey)),n&&(i[this.config.replyKey]=this.getReplyValue(n,this.config.replyValueKey)),this.config.addRequest(Object(r["a"])(Object(r["a"])({},i),this.config.addParams||{})).then((function(t){t.data.user={userId:a.userInfo.userId,realname:a.userInfo.realname,img:a.userInfo.img},t.data.replyUser=n?n.user:o.user,a.list[s[0]].childCommentList.push(t.data),a.replyIndex=null,a.commentLoading=!1})).catch((function(){a.commentLoading=!1}))},getReplyValue:function(t,e){if(e.indexOf(".")<0)return t[e];for(var a=e.split("."),i=t,n=0;n<a.length;n++)if(i=i[a[n]],void 0===i)return"";return i},handleToDelete:function(t,e){var a=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1;this.$confirm("确定删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){a.config.deleteRequest(Object(r["a"])({commentId:t.commentId},a.config.deleteParams||{})).then((function(t){a.$message({type:"success",message:"删除成功!"}),i>=0?a.list[e].childCommentList.splice(i,1):a.$emit("delete",e)}))})).catch((function(){a.$message({type:"info",message:"已取消删除"})}))}}},dt=lt,ut=(a("2a91"),Object(v["a"])(dt,et,at,!1,null,"763147b0",null)),pt=ut.exports,ht=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"comment-list"},t._l("activity"===t.type?t.list:t.hoursList,(function(e,i){return a("div",{key:i,staticClass:"comment-list-item"},[a("div",{staticClass:"parent-reply reply"},[a("div",{staticClass:"user-info"},[a("xr-avatar",{staticClass:"user-img",attrs:{id:e.userId,name:e.realname,size:32,src:e.img,disabled:!1}}),t._v(" "),a("div",{staticClass:"user-info__bd"},[a("span",{staticClass:"user"},[t._v(t._s(e.realname))]),t._v(" "),a("span",{staticClass:"time"},[t._v("\n            "+t._s(e.createTime)+"\n          ")])])],1),t._v(" "),a("div",{staticClass:"content"},[t._v(t._s(e.content))])])])})))},mt=[],ft={name:"CommentList",components:{},filters:{},props:{list:{type:Array,required:!0},hoursList:{type:Array,default:function(){return[]}},type:{type:String,required:!0}},data:function(){return{}},methods:{}},bt=ft,gt=(a("86906"),Object(v["a"])(bt,ht,mt,!1,null,"10a136fa",null)),vt=gt.exports,kt=a("c1df"),yt=a.n(kt),Tt=a("6651"),wt={name:"ItemDetail",components:{SlideView:u["a"],WkDetailHeader:p["a"],Tinymce:h["a"],TagIndex:W,SubWorkItem:y,FileCell:tt["a"],WkUserSelect:Y["a"],CommentList:pt,ActivityList:vt,ReplyComment:it["a"],WkHeadSection:T["a"],WkSectionItem:w["a"],WkEditWrap:C["a"],TagView:j["a"],WkQuickCreateBar:q["a"],CreateWorkTime:Q,StatusTag:Z["a"]},props:{id:[String,Number],detailIndex:Number,detailSection:Number,noListenerClass:{type:Array,default:function(){return["el-table__body"]}},pageList:Array,projectAuth:{type:Object,default:function(){return null}}},data:function(){var t=this;return{loading:null,projectDetail:null,canShowDetail:!0,ownerUserUnfold:!1,showSearchIteration:!1,currentItem:"",itemName:"",priorityVisible:!1,priorityList:Tt["f"],startTimeOptions:{disabledDate:function(e){return!(!t.taskData||!t.taskData.stopTime)&&yt()(e).isAfter(t.taskData.stopTime)}},stopTimeOptions:{disabledDate:function(e){return!(!t.taskData||!t.taskData.startTime)&&yt()(e).isBefore(t.taskData.startTime)}},addSubtasks:!0,addDescriptionShow:!1,expand:!1,autoUpload:!1,addDescriptionTextarea:"",htmlHeght:0,subTaskDoneNum:0,allData:{},commentsLoading:!1,subTaskID:null,taskData:null,activityList:[],hoursList:[],fileList:[],replyList:[],tabValue:"comment",showEditTitle:!1,descShow:!1,editDesc:!1,childShow:!1,wikiShow:!1,fileShow:!1,workTimeShow:!1,editProgress:!1,childTask:[],handleOperations:[{command:"delete",name:"删除",icon:""}],showEditWorkTime:!1,workTimeRecord:{},itemType:"",allStatusList:[],calcHeight:600,relatedDemandLoading:!1,relatedDemandOptions:[],wrongTypes:[{label:"功能缺陷",key:1},{label:"UI界面问题",key:2},{label:"易用性问题",key:3},{label:"安全问题",key:4},{label:"性能问题",key:5},{label:"代码错误",key:6}],editingObj:{relatedDemandId:!1,wrongType:!1},projectOwnerRoleList:[]}},computed:Object(r["a"])(Object(r["a"])({},Object(J["b"])(["userInfo"])),{},{isWorkbench:function(){return"workbench"===this.$route.name},projectId:function(){var t;return null===(t=this.taskData)||void 0===t?void 0:t.projectId},priority:function(){return this.getPriorityColor(this.taskData.priority)},title:function(){return this.taskData.name},subTitle:function(){return"".concat(this.taskData.createUserName,"创建于").concat(this.taskData.createTime)},isAgileProject:function(){var t;return 2==(null===(t=this.taskData)||void 0===t?void 0:t.projectType)},activityHandle:function(){var t=[{command:"desc",icon:"wk wk-icon-edit-des",label:"编辑描述",auth:"oa.taskExamine"},{command:"child",icon:"wk wk-icon-add-sub",label:"添加子工作项",auth:"crm.contacts.save"},{command:"file",icon:"wk wk-icon-file",label:"上传附件",auth:"crm.contacts.save"},{command:"worktime",icon:"wk wk-icon-time",label:"添加工时",auth:"crm.contacts.save"}];return this.isAgileProject?t:t.filter((function(t){return["desc","relation","file"].includes(t.command)}))},detailList:function(){var t,e=[{label:"所属迭代",formType:"follow",field:"belongIterationName"},{label:"关联需求",formType:"item",field:"relatedDemandId"},{label:"缺陷类型",formType:"wrongType",field:"wrongType"},{label:"处理人",formType:"priority",field:"mainUser"},{label:"优先级",formType:"priority",field:"priority"},{label:"创建者",formType:"createUser",field:"createUserName"},{label:"开始时间",formType:"date",field:"startTime"},{label:"截止时间",formType:"date",field:"stopTime"},{label:"团队成员",formType:"memeber",field:"projectOwnerRoleList"},{label:"进度",formType:"progress",field:"progress"},{label:"预估工时",formType:"futureTime",field:"estimatedManHours"},{label:"工时记录",formType:"timeRecord",field:"taskTimeList"},{label:"更新时间",formType:"date",field:"updateTime"},{label:"创建时间",formType:"date",field:"createTime"}];return this.isAgileProject?4===(null===(t=this.taskData)||void 0===t?void 0:t.type)?e:e.filter((function(t){return!["item","wrongType"].includes(t.formType)})):e.filter((function(t){return!["item","wrongType","follow","progress","futureTime","timeRecord"].includes(t.formType)}))},statusColor:function(){return["",{color:"#0052CC",bgColor:"#DEEBFF"},{color:"#EC8205",bgColor:"#FFEACF"},{color:"#006644",bgColor:"#E3FCEF"}][this.taskData.status]},recordPercentage:function(){return this.workTimeRecord.actualHour/(this.workTimeRecord.actualHour+this.workTimeRecord.surplusHours)*100},ownerListRequest:function(){return this.projectId?c["u"]:null},ownerListParams:function(){return{projectId:this.projectId}},labelList:function(){return this.taskData?this.taskData.labelTaskList||[]:null},tagLabelList:function(){return(this.labelList||[]).map((function(t){return{name:t.name,value:t.color?t.color:"#ccc"}}))},relatedData:function(){var t=0;for(var e in this.allData)t+=this.allData[e].length;return t},commentListProps:function(){return{addRequest:l["E"],addParams:{typeId:this.taskData?this.taskData.taskId:"",type:"1"},replyKey:"pid",replyValueKey:"userId",deleteRequest:l["d"],deleteParams:null}},editAuth:function(){var t,e;return this.isWorkbench?(null===(t=this.projectAuth)||void 0===t||null===(e=t.coordination)||void 0===e?void 0:e.editMatters)||!1:this.$auth("coordination.editMatters","PM")},delAuth:function(){var t,e;return this.isWorkbench?(null===(t=this.projectAuth)||void 0===t||null===(e=t.coordination)||void 0===e?void 0:e.deletMatters)||!1:this.$auth("coordination.deletMatters","PM")},handleAuthOperations:function(){return this.delAuth?this.handleOperations:[]},tabs:function(){var t=[{label:"评论",value:"comment"},{label:"活动",value:"activity"}];return this.projectDetail&&2==this.projectDetail.type&&t.push({label:"工时日志",value:"hours"}),t},ownerUserShowList:function(){var t=this.projectDetail.projectOwnerRoleList||[];return t.length>0?t.slice(0,5):t},ownerUserHideList:function(){var t=this.projectDetail.projectOwnerRoleList||[];return t.length>0?t.slice(5):t}}),watch:{id:function(t){this.initInfo(),this.getDetail(),this.getCommentList(),this.getActivityList()},tabValue:function(){this.getActivityList()}},mounted:function(){var t=this;this.calcHeight=document.documentElement.clientHeight-165,window.onresize=function(){t.calcHeight=document.documentElement.clientHeight-165}},beforeDestroy:function(){},methods:{getProjectDetail:function(){var t=this;this.loading=!0,Object(c["r"])({projectId:this.projectId?this.projectId:this.$route.params.id,taskId:this.id}).then((function(e){t.projectDetail=e.data||{},t.projectOwnerRoleList=e.data.projectOwnerRoleList.map((function(t){return t.userId}))||[],t.loading=!1})).catch((function(){t.loading=!1}))},viewAfterEnter:function(){this.id&&(this.getDetail(),this.getCommentList(),this.getActivityList())},handleUpdateParentList:function(){this.$emit("update-list")},initInfo:function(){this.taskData=null,this.itemType="",this.subTaskDoneNum=0,this.addDescriptionShow=!1,this.priorityVisible=!1,this.addSubtasks=!0,this.addDescriptionTextarea="",this.allData={business:[],contacts:[],contract:[],customer:[],receivables:[]},this.activityList=[],this.fileList=[],this.replyList=[]},getDetail:function(){var t=this;this.loading=!0,Object(l["Q"])({taskId:this.id}).then((function(e){var a,i=e.data||{};i.checked=3==i.status,null!==(a=i.childTaskList)&&void 0!==a&&a.length&&(t.childTask=i.childTaskList.map((function(t){return 3==t.status?t.checked=!0:t.checked=!1,t})),t.childShow=!0),t.fileList=i.file||[],t.fileList.length&&(t.fileShow=!0),i.description&&(t.descShow=!0);var n,s=0,r=i.taskTimeList,c=Object(o["a"])(r);try{for(c.s();!(n=c.n()).done;){var l=n.value;s+=l.actualHour}}catch(d){c.e(d)}finally{c.f()}t.workTimeRecord={actualHour:s,surplusHours:r.length?r[r.length-1].surplusHours:0},t.itemType=["Require","Task","Defects"][i.type-2],t.allData={business:(i.businessList||[]).map((function(t){return t.id&&(t.businessId=t.id),t})),contacts:(i.contactsList||[]).map((function(t){return t.id&&(t.contactsId=t.id),t})),contract:(i.contractList||[]).map((function(t){return t.id&&(t.contractId=t.id),t})),customer:(i.customerList||[]).map((function(t){return t.id&&(t.customerId=t.id),t})),receivables:(i.receivablesList||[]).map((function(t){return t.id&&(t.receivablesId=t.id,t.name=t.customerName),t}))},t.taskData=i,i.relatedDemandId&&(t.relatedDemandOptions=[{name:i.relatedDemandName,taskId:i.relatedDemandId}]),t.getAllStatus(),t.getProjectDetail(),t.loading=!1,t.$nextTick((function(){t.autoUpload=!0})),i.description&&t.updateDescHeight(i.description)})).catch((function(e){t.loading=!1,e&&3007==e.code?t.canShowDetail=!1:t.closeBtn()}))},updateDescHeight:function(t){var e=this;this.$nextTick((function(){e.addDescriptionTextarea=t,setTimeout((function(){var a;t.includes("<img")?document.querySelectorAll(".desc-box img").forEach((function(t){t.onload=function(){e.htmlHeght=e.$refs.descWrap.offsetHeight}})):e.htmlHeght=null===(a=e.$refs.descWrap)||void 0===a?void 0:a.offsetHeight}),0)}))},saveItemTitle:function(){var t=this;this.showEditTitle=!1;var e={name:this.taskData.name,taskId:this.taskData.taskId};Object(l["H"])(e).then((function(e){t.$message.success("操作成功"),t.handleUpdateParentList()})).catch((function(){}))},getAllStatus:function(){var t=this,e={eventId:this.taskData.eventId,projectId:this.projectId};Object(d["b"])(e).then((function(e){t.allStatusList=e.data||[]}))},handleCloseSub:function(t){this.$set(t,"showEdit",!1)},hideProgress:function(){var t=this;this.editProgress=!1;var e={taskId:this.taskData.taskId,progress:this.taskData.progress};Object(l["Z"])(e).then((function(){t.$message.success("操作成功"),t.handleUpdateParentList(),t.getActivityList()})).catch((function(){t.$message.success("操作失败")}))},getRelatedDemandData:function(t){var e=this,a={name:t,projectId:this.projectId,pageType:0,type:2};this.relatedDemandLoading=!0,Object(l["R"])(a).then((function(t){var a=t.data.list||[];if(e.taskData.relatedDemandId){var i=a.find((function(t){return t.taskId===e.taskData.relatedDemandId}));i||a.push({name:e.taskData.relatedDemandName,taskId:e.taskData.relatedDemandId})}e.relatedDemandOptions=a,e.relatedDemandLoading=!1})).catch((function(){e.relatedDemandLoading=!1}))},handleSave:function(t){var e=this,a={companyId:this.userInfo.companyId,type:Tt["e"][this.itemType],projectId:this.projectId,name:t.name,pid:this.taskData.taskId};"edit"==t.type&&(a.taskId=t.subId);var i={add:l["ab"],edit:l["qb"]}[t.type];i(a).then((function(a){var i="edit"==t.type?"编辑子工作项成功":"添加子工作项成功";"edit"==t.type&&(e.childTask[t.index].showEdit=!1),e.$message.success(i),e.getChildTask()})).catch((function(){}))},getChildTask:function(){var t=this,e={taskId:this.id,pageType:0,type:3};Object(l["S"])(e).then((function(e){t.childTask=(e.data.list||[]).map((function(e){return 3==e.status?(e.checked=!0,t.subTaskDoneNum++):e.checked=!1,e})),t.childTask.length&&(t.childShow=!0)})).catch((function(){}))},handlePriorityIcon:function(t){return Object(Tt["c"])(t)},querySearchAsync:function(t,e){var a=this,i=this.taskData.belongIterationName?[{type:"btn",name:"移出迭代"}]:[];if(t){var n={name:t,projectId:this.projectId,type:0,pageType:0};Object(l["T"])(n).then((function(n){var o=n.data.list,r=t?o.filter(a.createStateFilter(t)):o;e([].concat(i,Object(s["a"])(r)))})).catch((function(){e([].concat(i))}))}else e([].concat(i))},createStateFilter:function(t){return function(e){return 0===e.name.toLowerCase().indexOf(t.toLowerCase())}},handleSelect:function(t){var e=this;if("btn"==t.type){var a={taskIds:[this.taskData.taskId],belongIterationId:""};Object(l["D"])(a).then((function(t){e.currentItem="",e.itemName="",e.taskData.belongIterationName="",e.showSearchIteration=!1,e.getDetail(),e.handleUpdateParentList()})).catch((function(){}))}else{var i={taskIds:[this.taskData.taskId],belongIterationId:t.taskId};Object(l["D"])(i).then((function(a){e.currentItem=t,e.itemName=t.name,e.taskData.belongIterationName=t.name,e.showSearchIteration=!1,e.getDetail(),e.handleUpdateParentList()})).catch((function(){}))}},handleWorkTime:function(){var t=this;this.showEditWorkTime=!1;var e={taskId:this.taskData.taskId,estimatedManHours:this.taskData.estimatedManHours};Object(l["X"])(e).then((function(){t.$message.success("操作成功"),t.handleUpdateParentList(),t.getActivityList()})).catch((function(){t.$message.success("操作失败")}))},handleRefresh:function(){this.workTimeShow=!1,this.getDetail(),this.getActivityList()},headerRightClick:function(t){var e=this;"delete"==t&&this.$confirm("确定删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var t={taskId:e.id};Object(l["N"])(t).then((function(t){e.$message({type:"success",message:"删除成功"}),e.hideView(),e.handleUpdateParentList()})).catch((function(){}))})).catch((function(){}))},quickCreateClick:function(t){var e=this;switch(t){case"desc":this.addDescriptionShow=!0,this.addDescriptionTextarea=this.taskData.description,this.descShow=!0,this.editDesc=!0;break;case"child":this.childShow=!0,this.$nextTick((function(){e.addSubtasks=!1}));break;case"wiki":this.wikiShow=!0;break;case"file":this.fileShow=!0,this.$nextTick((function(){e.$refs.fileUpload&&e.$refs.fileUpload.$refs["upload-inner"].$refs.input.click()}));break;case"worktime":this.workTimeShow=!0;break}},getIconClass:function(t){var e=t.pid?"sub":t.type;return{2:a("a123"),3:a("94dd"),4:a("6894")}[e]},getActivityList:function(){var t=this,e={taskId:this.id,type:1},a={taskId:this.id,type:2};this.loading=!0,Promise.all([Object(l["u"])(e),Object(l["u"])(a)]).then((function(e){t.activityList=e[0].data,t.hoursList=e[1].data,t.loading=!1})).catch((function(){t.loading=!1}))},getCommentList:function(){var t=this;Object(l["v"])({type:1,taskId:this.id}).then((function(e){t.replyList=e.data})).catch((function(){}))},setItemStatus:function(t){var e=this,a={statusId:t,taskId:this.id};Object(l["r"])(a).then((function(t){e.$message.success("设置成功"),e.getDetail(),e.handleUpdateParentList(),e.getActivityList})).catch((function(){}))},getPermission:function(t){return!!this.editAuth},closeBtn:function(){this.$emit("close")},changePriority:function(t){var e=this;Object(l["Y"])({taskId:this.id,priority:t}).then((function(a){e.taskData.priority=t,e.priorityVisible=!1,e.handleUpdateParentList(),e.getActivityList()})).catch((function(){e.$message.error("编辑失败")}))},httpRequest:function(t){var e=this;this.$wkUploadFile.upload({file:t.file,params:{batchId:this.taskData.batchId}}).then((function(t){var a=t.res;e.getDetail(),e.$message.success("上传成功"),e.refreshLog({taskIds:e.taskData.taskId,operationType:1,fileName:a.data.name})})).catch((function(){}))},accessoryDeleteFun:function(t,e){this.fileList.splice(t,1),this.refreshLog({taskIds:this.taskData.taskId,operationType:3,fileName:e.name})},refreshLog:function(t){var e=this;Object(l["L"])(t).then((function(t){e.getActivityList()})).catch((function(){}))},subtasksCheckbox:function(t,e){var a=this;e?(this.$set(t,"checked",!0),this.subTaskDoneNum++):(this.$set(t,"checked",!1),this.subTaskDoneNum--),Object(l["t"])({taskId:t.taskId,status:e?3:1}).then((function(t){a.$emit("on-handle",{type:"change-sub-task",value:{subdonecount:a.subTaskDoneNum,allcount:a.childTask.length},index:a.detailIndex,section:a.detailSection})})).catch((function(){a.$message.error("子任务标记失败"),e?(a.$set(t,"checked",!1),a.subTaskDoneNum--):(a.$set(t,"checked",!0),a.subTaskDoneNum++)}))},mainUserChange:function(t,e){var a=e.length>0?e[0]:null;this.submiteMainUser(a)},taskUserChange:function(t,e){this.projectOwnerRoleList=t,this.projectDetail.projectOwnerRoleList=e},setTaskUser:function(){Object(l["C"])({projectId:this.projectId?this.projectId:this.$route.params.id,taskId:this.id,userIds:this.projectOwnerRoleList}).then((function(t){})).catch((function(){}))},submiteMainUser:function(t){var e=this;Object(l["F"])({taskId:this.id,mainUserId:t?t.userId:""}).then((function(t){e.getDetail(),e.handleUpdateParentList(),e.getActivityList()})).catch((function(){}))},deleteTime:function(t){this.taskData[t]="",this.timeChange(t,!0)},timeChange:function(t){var e=this,a=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i={taskId:this.id,startTime:"startTime"==t&&a?"":this.taskData.startTime||"",stopTime:"endTime"==t&&a?"":this.taskData.stopTime||""};Object(l["I"])(i).then((function(){e.$message.success("操作成功"),e.getDetail(),e.handleUpdateParentList(),e.getActivityList()}))},previewImg:function(t){var e=t.target,a=e.tagName,i=e.src;if("IMG"===a){var n=i.split("/");this.$wkPreviewFile.preview({index:0,data:[{url:i,name:n[n.length-1]}]})}},submiteDescription:function(){var t=this;Object(l["G"])({taskId:this.id,description:this.addDescriptionTextarea}).then((function(e){t.addDescriptionShow=!1,t.editDesc=!1,t.$set(t.taskData,"description",t.addDescriptionTextarea),t.updateDescHeight(t.addDescriptionTextarea),t.handleUpdateParentList(),t.$message.success("保存成功")})).catch((function(){}))},cancelEditDesc:function(){this.addDescriptionTextarea=this.taskData.description},relatedDemandChange:function(){var t=this;Object(l["s"])({taskIds:[this.id],relatedDemandId:this.taskData.relatedDemandId}).then((function(e){if(t.taskData.relatedDemandId){var a=t.relatedDemandOptions.find((function(e){return e.taskId===t.taskData.relatedDemandId}));t.$set(t.taskData,"relatedDemandId",a.taskId),t.$set(t.taskData,"relatedDemandName",a.name)}else t.$set(t.taskData,"relatedDemandId",""),t.$set(t.taskData,"relatedDemandName","");t.handleUpdateParentList()})).catch((function(){}))},wrongTypeChange:function(){var t=this;Object(l["bb"])({projectId:this.projectId,taskId:this.id,wrongType:this.taskData.wrongType}).then((function(e){t.handleUpdateParentList(),t.getActivityList()})).catch((function(){}))},editChangeSave:function(){for(var t in this.editingObj)this.editingObj[t]=!1;this.showSearchIteration=!1},editOpen:function(t){var e=this;this.editAuth&&this.$nextTick((function(){"belongIterationName"===t?e.showSearchIteration=!0:e.editingObj[t]=!0}))},handleReply:function(t){var e=this;t&&(this.commentsLoading=!0,Object(l["E"])(Object(r["a"])({content:st()(t)},this.commentListProps.addParams)).then((function(t){e.getCommentList(),e.$refs.f_reply.commentsTextarea="",e.commentsLoading=!1})).catch((function(){e.commentsLoading=!1})))},deleteComment:function(t){this.replyList.splice(t,1)},deleteSubTask:function(t){var e=this;this.$confirm("此操作将删除该任务, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",customClass:"is-particulars"}).then((function(){Object(l["N"])(t).then((function(a){var i=e.childTask;for(var n in i)if(i[n].taskId==t.taskId){i.splice(n,1);break}t.checked&&e.subTaskDoneNum--,e.$message.success("子工作项删除成功")})).catch((function(){e.$message.error("子工作项删除失败")}))})).catch((function(){e.$message({type:"info",message:"已取消删除"})}))},editSubTask:function(t){this.subTaskID=t.taskId;var e=this.childTask;for(var a in e)e[a].taskId==t.taskId?this.$set(e[a],"showEdit",!0):this.$set(e[a],"showEdit",!1)},hideView:function(){this.$emit("close"),this.$emit("hide-view")},closeOtherReply:function(t){!t&&this.$refs.comment_list&&this.$refs.comment_list.closeReply()},handleSubTask:function(t){"update"===t.type?this.editSubTask(t.data):"delete"===t.type&&this.deleteSubTask(t.data)}}},Ct=wt,jt=(a("4213"),Object(v["a"])(Ct,i,n,!1,null,"0336944d",null));e["default"]=jt.exports},eb71:function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"normal-list"},[a("el-table",{staticStyle:{width:"100%"},attrs:{id:"crm-table","row-height":t.rowHeight,data:t.list,height:t.tableHeight,"cell-class-name":t.cellClassName,"row-key":"taskId","use-virtual":"","highlight-current-row":""},on:{"row-click":t.handleRowClick,"header-dragend":t.handleHeaderDragend}},[t._l(t.fieldList,(function(e,i){return a("el-table-column",{key:i,attrs:{fixed:1===e.isLock,prop:e.prop,label:e.label,width:e.width,"min-width":e.minWidth,"class-name":e.width>60?"column":"","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(i){var n=i.row;return["num"==e.prop?[t._v("#"+t._s(n[e.prop]))]:"name"==e.prop?a("span",{staticClass:"icon-name"},["Iterations"!=t.itemType?a("img",{staticClass:"item-img",attrs:{src:t.getIconClass(n),alt:""}}):t._e(),t._v(" "),a("span",{staticClass:"item-title can-visit--underline"},[t._v(t._s(n[e.prop]))])]):"status"==e.prop&&"Iterations"==t.itemType?a("status-tag",{staticStyle:{"margin-right":"8px"},attrs:{"status-name":n.boardStatusName,type:n.status}}):"status"==e.prop&&"Iterations"!=t.itemType?a("el-dropdown",{staticClass:"priority-box",attrs:{placement:t.placement,disabled:t.getDisabledAuth(n.taskAuth)},on:{command:function(e){t.setItemStatus(e,n.taskId)}},nativeOn:{click:function(e){t.handleDropdown(e,n.type-1)}}},[a("flexbox",[a("status-tag",{staticClass:"cell-tag",attrs:{"status-name":n.boardStatusName,type:n.status}}),t._v(" "),a("i",{staticClass:"wk wk-icon-caret-bottom bottom-icon"})],1),t._v(" "),a("el-dropdown-menu",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"dropdown-menu",staticStyle:{padding:"4px 0",overflow:"auto"},style:{padding:0===t.allStatusList.length?"0px":"auto"},attrs:{slot:"dropdown"},slot:"dropdown"},t._l(t.allStatusList,(function(t,e){return a("el-dropdown-item",{key:e,staticStyle:{padding:"0 10px"},attrs:{command:t.id}},[a("div",{staticClass:"dorp-item"},[a("status-tag",{attrs:{"is-drop":!0,type:t.statusType,"status-name":t.statusName}})],1)])})))],1):"mainUserName"==e.prop&&"Iterations"!=t.itemType?a("span",{staticClass:"icon-name"},[a("wk-user-select",{staticStyle:{width:"100%"},attrs:{disabled:t.getDisabledAuth(n.taskAuth),value:n.mainUserId||"",request:t.ownerListRequest,params:{projectId:n.projectId},props:{isList:!0},radio:""},on:{change:function(e){t.mainUserChange(arguments,n.taskId)}}},[a("flexbox",{staticClass:"head-btn",attrs:{slot:"reference"},slot:"reference"},[n.mainUserId?t._e():a("span",{staticClass:"head-btn__text"},[t._v("\n                "+t._s(t.getDisabledAuth(n.taskAuth)?"":"未指定")+"\n              ")]),t._v(" "),a("div",{staticClass:"head-btn__bd"},[n.mainUserId?a("div",{staticClass:"head-btn__bd--name",staticStyle:{"font-size":"14px"}},[t._v("\n                  "+t._s(n.mainUserName)+"\n                ")]):t._e()]),t._v(" "),a("i",{staticClass:"wk wk-icon-caret-bottom bottom-icon"})])],1)],1):"priority"==e.prop&&"Iterations"==t.itemType?a("span",{staticClass:"icon-name"},["Iterations"!=t.itemType?a("img",{staticClass:"item-img",attrs:{src:t.getPriorityPic(n[e.prop]),alt:""}}):t._e(),t._v(" "),a("span",[t._v(t._s(t.getPriority(n[e.prop])))])]):"priority"==e.prop&&"Iterations"!=t.itemType?a("span",{staticClass:"icon-name"},[a("el-dropdown",{staticClass:"priority-box",attrs:{placement:"bottom-start",disabled:t.getDisabledAuth(n.taskAuth)},on:{command:function(e){t.changePriority(e,n.taskId)}}},[a("div",{staticClass:"priority-wrap"},[a("img",{staticClass:"priority-icon",attrs:{src:t.getPriorityPic(n[e.prop]),alt:""}}),t._v(" "),a("span",{staticStyle:{"padding-right":"8px"}},[t._v(t._s(t.getPriority(n[e.prop])))]),t._v(" "),a("i",{staticClass:"wk wk-icon-caret-bottom bottom-icon"})]),t._v(" "),a("el-dropdown-menu",{staticStyle:{"min-width":"100px",padding:"4px 0"},attrs:{slot:"dropdown"},slot:"dropdown"},t._l(t.priorityList,(function(e,i){return a("el-dropdown-item",{key:i,staticStyle:{padding:"0 10px"},attrs:{command:e.key}},[a("div",{staticClass:"priority-wrap"},[a("img",{staticClass:"priority-icon",attrs:{src:e.icon,alt:""}}),t._v(t._s(e.label)+"\n                ")])])})))],1)],1):"belongProjectName"==e.prop?a("flexbox",[a("flexbox",{staticClass:"icon-box",attrs:{align:"center",justify:"center"}},[a("i",{staticClass:"icon",class:n.projectIcon})]),t._v(" "),a("span",{staticClass:"project-name text"},[t._v("\n            "+t._s(n[e.prop])+"\n            "),2==n.projectType?a("span",{staticClass:"agile-sign"},[t._v("敏捷")]):1==n.projectType?a("span",{staticClass:"ordinary-sign"},[t._v("普通")]):t._e()])],1):"belongIterationProgress"==e.prop?a("span",[t._v(t._s(Math.round(n[e.prop])||0)+"%")]):"projectAdminRoleList"==e.prop?a("span",[t._v(t._s(t.getAdminList(n[e.prop])))]):"stopTime"==e.prop&&"Iterations"==t.itemType&&n.stopTime?a("el-tag",{staticClass:"project-tag",class:[3==n.status?"is-common":t.getOverTimeStatus(n.stopTime)],attrs:{"disable-transitions":""}},[t._v("\n          "+t._s(t.formatTime(n.stopTime))+"\n        ")]):"stopTime"==e.prop&&"Iterations"!=t.itemType?a("div",{staticClass:"stop-time"},[n.stopTime?t._e():a("span",{staticClass:"head-btn__text"},[t._v("\n            "+t._s(t.getDisabledAuth(n.taskAuth)?"":"未选择")+"\n          ")]),t._v(" "),a("el-date-picker",{attrs:{disabled:t.getDisabledAuth(n.taskAuth),clearable:!1,type:"date","value-format":"yyyy-MM-dd"},on:{change:function(e){t.timeChange(n.stopTime,n.taskId)}},model:{value:n.stopTime,callback:function(e){t.$set(n,"stopTime",e)},expression:"row.stopTime"}}),t._v(" "),n.stopTime?a("el-tag",{staticClass:"project-tag",class:[3==n.status?"is-common":t.getOverTimeStatus(n.stopTime)],attrs:{"disable-transitions":""}},[t._v("\n            "+t._s(t.formatTime(n.stopTime))+"\n          ")]):t._e(),t._v(" "),a("i",{staticClass:"wk wk-icon-caret-bottom bottom-icon"})],1):a("span",[t._v(t._s(n[e.prop]))])]}}])})})),t._v(" "),a("el-table-column")],2)],1)},n=[],s=(a("a15b"),a("d81d"),a("b0c0"),a("1658")),o=a("e04a"),r=a("a535"),c=a("1557"),l=a("5c0a"),d=a("6651"),u=a("b85c"),p=(a("a9e3"),a("4de4"),a("d3b7"),a("caad"),a("14d9"),a("159b"),a("99af"),a("7a1a")),h={components:{StatusTag:c["a"]},props:{tableHeight:Number,rowHeight:Number,projectDetail:Object},data:function(){return{fieldList:[],iterationsList:[{prop:"num",label:"引用ID",width:"70",isLock:1},{prop:"name",label:"迭代名称",width:"220",isLock:1},{prop:"startTime",label:"开始时间",minWidth:"160"},{prop:"stopTime",label:"结束时间",minWidth:"160"},{prop:"status",label:"状态",minWidth:"100"},{prop:"belongIterationProgress",label:"进度"},{prop:"mainUserName",label:"负责人"}],moduleMap:{All:0,Iterations:1,Require:2,Task:3,Defects:4}}},computed:{isAgility:function(){var t;return 2===(null===(t=this.projectDetail)||void 0===t?void 0:t.type)},editAuth:function(){return this.$auth("coordination.editMatters","PM")},isWorkbench:function(){return"workbench"===this.$route.name}},created:function(){this.getField(),this.debouncePostWidthChange=Object(p["debounce"])(500,this.postWidthChange)},mounted:function(){},methods:{getField:function(){var t=this,e={projectId:this.$route.params.id,moduleType:this.moduleMap[this.itemType]};Object(s["P"])(e).then((function(e){var a,i=[],n=Object(u["a"])(e.data||[]);try{for(n.s();!(a=n.n()).done;){var s=a.value,o=s.fieldName,r=s.name,c=s.width;if(3===t.projectDetail.type||"belongProjectName"!==o){var l={prop:o,label:r,width:c};["num","name"].includes(o)&&(l.isLock=1),i.push(l)}}}catch(d){n.e(d)}finally{n.f()}t.fieldList=t.isAgility?i:i.filter((function(t){return!["belongIterationName"].includes(t.prop)}))})).catch((function(){}))},handleHeaderDragend:function(t,e,a,i){this.debouncePostWidthChange(t,a)},postWidthChange:function(t,e){if(e.property){var a;this.fieldList.forEach((function(a){e.property===a.prop&&(a.width=t)}));var i={projectId:this.$route.params.id||0,schemeId:(null===(a=this.projectDetail)||void 0===a?void 0:a.schemeId)||0,moduleType:this.moduleMap[this.itemType],fieldSorts:this.fieldList.map((function(t){return{fieldName:t.prop,name:t.label,width:t.width}}))};Object(s["O"])(i).then((function(t){})).catch((function(){}))}},getList:function(){this.$emit("get-list")},cellClassName:function(t){var e=t.row,a=t.column;t.rowIndex,t.columnIndex;return"name"===a.property?"can-visit--underline":["priority","status","mainUserName","stopTime"].includes(a.property)&&!this.getDisabledAuth(e.taskAuth)&&"Iterations"!=this.itemType?"td-hover":""},handleRowClick:function(t,e,a){"name"==e.property?this.isWorkbench&&"Iterations"===this.$route.query.tab?window.open("".concat(location.origin+location.pathname,"#/project/subs/team/").concat(t.projectId,"?tab=Iterations&type=iteration-detail&taskId=").concat(t.taskId)):this.$emit("handle",{type:"detail",row:t}):"status"==e.property&&this.getStatusList(t)},getDisabledAuth:function(t){return 3===this.projectDetail.type?!t.coordination.editMatters:!this.editAuth}}},m=a("c1df"),f=a.n(m),b={name:"TableList",components:{StatusTag:c["a"],WkUserSelect:l["a"]},mixins:[h],props:{itemType:String,list:{type:Array,default:function(){return[]}}},data:function(){return{loading:!1,priorityList:d["f"],allStatusList:[],placement:"bottom-start"}},computed:{ownerListRequest:function(){return r["u"]}},methods:{getPriority:function(t){return Object(d["a"])(t)},getPriorityPic:function(t){return Object(d["c"])(t)},getAdminList:function(t){return(t||[]).map((function(t){return t.realname})).join()},fomartTime:function(t){return t?f()(t).format("YYYY-MM-DD"):"--"},getIconClass:function(t){return Object(d["b"])(t)},getOverTimeStatus:function(t){var e=this.handleTime(t);return"今天"===e||"明天"===e?"is-near":this.$moment(t).isBefore(this.$moment())?"is-over":"is-common"},formatTime:function(t){if(!t)return null;var e=this.handleTime(t);return(e||this.getTime(t))+"截止"},getTime:function(t){var e=this.$moment().isSame(t,"year");return e?this.$moment(t).format("M月D日"):this.$moment(t).format("YYYY年M月D日")},handleTime:function(t){var e=this.$moment(t).format("YYYY-MM-DD").split("-"),a=new Date,i=[a.getFullYear(),a.getMonth()+1,a.getDate()],n=new Date(a.setTime(a.getTime()+864e5)),s=[n.getFullYear(),n.getMonth()+1,n.getDate()],o=new Date(a.setTime(a.getTime()-1728e5)),r=[o.getFullYear(),o.getMonth()+1,o.getDate()];return i[0]==e[0]&&i[1]==e[1]&&i[2]==e[2]?"今天":s[0]==e[0]&&s[1]==e[1]&&s[2]==e[2]?"明天":r[0]==e[0]&&r[1]==e[1]&&r[2]==e[2]&&"昨天"},timeChange:function(t,e){var a=this,i={taskId:e,stopTime:t||""};Object(s["I"])(i).then((function(){a.$message.success("操作成功"),a.$emit("get-list")})).catch((function(){a.$message.error("编辑失败")}))},changePriority:function(t,e){var a=this;Object(s["Y"])({taskId:e,priority:t}).then((function(t){a.$message.success("操作成功"),a.$emit("get-list")})).catch((function(){a.$message.error("编辑失败")}))},setItemStatus:function(t,e){var a=this,i={statusId:t,taskId:e};Object(s["r"])(i).then((function(t){a.$message.success("设置成功"),a.$emit("get-list")})).catch((function(){a.$message.error("编辑失败")}))},handleDropdown:function(t){var e=document.body.clientHeight,a=t.clientY,i=e-a;this.placement=i>417?"bottom-start":"top-start"},getStatusList:function(t){var e=this,a={projectId:t.projectId,eventId:t.type-1};Object(o["b"])(a).then((function(t){e.allStatusList=t.data||[],e.allStatusList.length||e.$message.error("当前无可选的状态")})).catch((function(){}))},mainUserChange:function(t,e){var a=t[1].length>0?t[1][0]:null;this.submiteMainUser(a,e)},submiteMainUser:function(t,e){var a=this;Object(s["F"])({taskId:e,mainUserId:t?t.userId:""}).then((function(t){a.$message.success("设置成功"),a.$emit("get-list"),"workbench"===a.$route.name&&a.$bus.emit("update-workbench-num")})).catch((function(){}))}}},g=b,v=(a("25f6"),a("2877")),k=Object(v["a"])(g,i,n,!1,null,"5008b6a8",null);e["a"]=k.exports},f183:function(t,e,a){var i=a("23e7"),n=a("e330"),s=a("d012"),o=a("861d"),r=a("1a2d"),c=a("9bf2").f,l=a("241c"),d=a("057f"),u=a("4fad"),p=a("90e3"),h=a("bb2f"),m=!1,f=p("meta"),b=0,g=function(t){c(t,f,{value:{objectID:"O"+b++,weakData:{}}})},v=function(t,e){if(!o(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!r(t,f)){if(!u(t))return"F";if(!e)return"E";g(t)}return t[f].objectID},k=function(t,e){if(!r(t,f)){if(!u(t))return!0;if(!e)return!1;g(t)}return t[f].weakData},y=function(t){return h&&m&&u(t)&&!r(t,f)&&g(t),t},T=function(){w.enable=function(){},m=!0;var t=l.f,e=n([].splice),a={};a[f]=1,t(a).length&&(l.f=function(a){for(var i=t(a),n=0,s=i.length;n<s;n++)if(i[n]===f){e(i,n,1);break}return i},i({target:"Object",stat:!0,forced:!0},{getOwnPropertyNames:d.f}))},w=t.exports={enable:T,fastKey:v,getWeakData:k,onFreeze:y};s[f]=!0}}]);