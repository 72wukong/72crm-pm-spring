(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7fe5c1a0"],{"187e":function(e,t,a){},"6f13":function(e,t,a){"use strict";a("187e")},"7e52":function(e,t,a){},"83f8":function(e,t,a){"use strict";a("7e52")},a67e:function(e,t,a){"use strict";a("f4c8")},ab3c:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"main"},[a("xr-header",[a("template",{slot:"label"},[e._v("\n      自定义角色设置\n      "),a("reminder",{staticClass:"project-reminder",attrs:{content:"为不同场景下的项目成员所需的权限设置匹配的项目、任务列表、任务的操作权限"}})],1),e._v(" "),a("el-button",{attrs:{slot:"ft",type:"primary"},on:{click:e.addJurisdiction},slot:"ft"},[e._v("新建角色")])],2),e._v(" "),a("div",{staticClass:"main-body"},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"main-table",class:e.WKConfig.tableStyle.class,staticStyle:{width:"100%"},attrs:{id:"examine-table",data:e.list,height:e.tableHeight,stripe:e.WKConfig.tableStyle.stripe,"highlight-current-row":""},on:{"row-click":e.handleRowClick}},[a("el-table-column",{attrs:{"show-overflow-tooltip":"",prop:"roleName",width:"150",label:"角色名称"}}),e._v(" "),a("el-table-column",{attrs:{"show-overflow-tooltip":"",prop:"remark",label:"角色描述"}}),e._v(" "),a("el-table-column",{attrs:{fixed:"right",label:"操作",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{staticStyle:{padding:"0"},attrs:{type:"primary-text"},on:{click:function(a){e.handleClick("edit",t)}}},[e._v("编辑")]),e._v(" "),a("el-button",{staticStyle:{padding:"0"},attrs:{type:"primary-text"},on:{click:function(a){e.handleClick("delete",t)}}},[e._v("删除")])]}}])})],1)],1),e._v(" "),a("jurisdiction-create",{attrs:{show:e.jurisdictionCreateShow,action:e.createAction},on:{"update:show":function(t){e.jurisdictionCreateShow=t},submite:e.getList}})],1)},i=[];a("a434"),a("b775");var l=a("8d55"),o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"create-dialog",attrs:{title:e.diaTitle,visible:e.show,"modal-append-to-body":!0,"append-to-body":!0,"close-on-click-modal":!1,width:"700px"},on:{close:e.closeView}},[a("div",{staticClass:"label-input"},[a("label",{staticClass:"label-title"},[e._v("角色名称")]),e._v(" "),a("el-input",{attrs:{maxlength:100,placeholder:"请输入角色名称"},model:{value:e.roleName,callback:function(t){e.roleName=t},expression:"roleName"}})],1),e._v(" "),a("div",{staticClass:"label-input"},[a("label",{staticClass:"label-title"},[e._v("角色描述")]),e._v(" "),a("el-input",{attrs:{rows:2,maxlength:300,type:"textarea",placeholder:"请输入角色描述"},model:{value:e.remark,callback:function(t){e.remark=t},expression:"remark"}})],1),e._v(" "),a("div",{staticClass:"label-input"},[a("label",{staticClass:"label-title"},[e._v("参考角色")]),e._v(" "),a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择"},on:{change:e.selectChange},model:{value:e.labelValue,callback:function(t){e.labelValue=t},expression:"labelValue"}},e._l(e.options,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})))],1),e._v(" "),a("label",{staticClass:"label-title"},[e._v("权限配置")]),e._v(" "),a("div",{staticClass:"jurisdiction-content-checkbox"},[a("el-tree",{ref:"tree",staticStyle:{height:"0"},attrs:{data:e.showTreeData,indent:0,"expand-on-click-node":!1,props:e.defaultProps,"show-checkbox":"","node-key":"menuId","empty-text":"","default-expand-all":""}})],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:e.sureClick}},[e._v("确定")]),e._v(" "),a("el-button",{on:{click:e.closeView}},[e._v("取消")])],1)])},s=[],c=(a("14d9"),{name:"JurisdictionCreate",components:{},props:{show:{type:Boolean,default:!1},action:{type:Object,default:function(){return{type:"save"}}}},data:function(){return{loading:!1,roleName:"",remark:"",showTreeData:[],defaultProps:{children:"childMenu",label:"menuName"},labelValue:"",options:[{value:0,label:"默认配置"},{value:1,label:"系统项目管理员"},{value:5,label:"开发"},{value:8,label:"项目经理"},{value:7,label:"测试"},{value:6,label:"产品"},{value:9,label:"运维"}]}},computed:{diaTitle:function(){return"save"==this.action.type?"新建":"编辑"}},watch:{show:function(e){e&&(this.labelValue="",this.initInfo())}},mounted:function(){},methods:{initInfo:function(){"update"==this.action.type?(this.roleName=this.action.data.roleName,this.remark=this.action.data.remark,this.labelValue=this.action.data.label):(this.roleName="",this.remark="",this.$refs.tree&&this.$refs.tree.setCheckedKeys([])),0==this.showTreeData.length?this.getRulesList():this.checkTreeByUpdateInfo()},getRulesList:function(){var e=this;this.loading=!0,Object(l["e"])(8).then((function(t){e.showTreeData=t.data.data?[t.data.data]:[],e.checkTreeByUpdateInfo(),e.loading=!1})).catch((function(){e.loading=!1}))},selectChange:function(){},checkTreeByUpdateInfo:function(){var e=this;this.$nextTick((function(){if(e.$refs.tree){"update"==e.action.type&&e.$refs.tree.setCheckedKeys(e.getUserModuleRules(e.action.data.rules.data));var t=e.$refs.tree.$children&&e.$refs.tree.$children.length?e.$refs.tree.$children[0].$el:null;t&&(t=t.children&&t.children.length?t.children[0]:null,t&&(t.style.display="none"))}}))},sureClick:function(){var e=this;if(this.roleName){this.loading=!0;var t=this.$refs.tree.getCheckedKeys(),a={roleName:this.roleName,remark:this.remark,menuIds:t,roleType:8,label:this.labelValue},n=l["a"];"update"==this.action.type&&(a.roleId=this.action.data.roleId,n=l["f"]),n(a).then((function(t){e.loading=!1,e.$message.success("操作成功"),e.$emit("submite"),e.closeView()})).catch((function(){e.loading=!1}))}else this.$message.error("请填写角色名称")},closeView:function(){this.$emit("update:show",!1)},getUserModuleRules:function(e){e||(e=[]);for(var t=this.showTreeData[0],a=!1,n=this.copyItem(e),i=0;i<t.childMenu.length;i++){var l=t.childMenu[i];l.childMenu||(l.childMenu=[]);for(var o=0;o<e.length;o++){for(var s=e[o],c=[],r=0;r<l.childMenu.length;r++){var u=l.childMenu[r];u.menuId==s&&c.push(u)}c.length!=l.childMenu.length&&(a=!0,this.removeItem(n,l.menuId))}}a&&this.removeItem(n,t.menuId);for(var d=[],h=0;h<n.length;h++){var f=n[h];f&&d.push(parseInt(f))}return d},copyItem:function(e){for(var t=[],a=0;a<e.length;a++)t.push(e[a]);return t},removeItem:function(e,t){for(var a=-1,n=0;n<e.length;n++)if(t==e[n]){a=n;break}a>0&&e.splice(a,1)},containItem:function(e,t){for(var a=0;a<e.length;a++)if(t==e[a])return!0;return!1}}}),r=c,u=(a("83f8"),a("2877")),d=Object(u["a"])(r,o,s,!1,null,"8e0c9670",null),h=d.exports,f=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("flexbox",{staticClass:"reminder-wrapper"},[a("flexbox",{staticClass:"reminder-body",attrs:{align:"stretch"}},[a("i",{staticClass:"wk wk-warning reminder-icon"}),e._v(" "),a("div",{staticClass:"reminder-content",style:{"font-size":e.fontSize+"px"},domProps:{innerHTML:e._s(e.content)}}),e._v(" "),e._t("default"),e._v(" "),e.closeShow?a("i",{staticClass:"el-icon-close close",on:{click:e.close}}):e._e()],2)],1)},p=[],m={name:"Reminder",components:{},props:{closeShow:{type:Boolean,default:!1},content:{type:String,default:"内容"},fontSize:{type:String,default:"14"}},data:function(){return{}},computed:{},mounted:function(){},destroyed:function(){},methods:{close:function(){this.$emit("close")}}},v=m,b=(a("b694"),Object(u["a"])(v,f,p,!1,null,"82904f82",null)),g=b.exports,y=a("f468"),_={name:"SystemProject",components:{JurisdictionCreate:h,Reminder:g,XrHeader:y["a"]},mixins:[],data:function(){return{loading:!1,tableHeight:document.documentElement.clientHeight-180,list:[],createAction:{type:"save"},jurisdictionCreateShow:!1}},computed:{},mounted:function(){var e=this;window.onresize=function(){e.tableHeight=document.documentElement.clientHeight-180},this.getList()},methods:{getList:function(){var e=this;this.loading=!0,Object(l["d"])(8).then((function(t){e.list=t.data,e.loading=!1})).catch((function(){e.loading=!1}))},addJurisdiction:function(){this.createAction={type:"save"},this.jurisdictionCreateShow=!0},handleRowClick:function(e,t,a){},handleClick:function(e,t){var a=this;"edit"===e?(this.createAction={type:"update",data:t.row},this.jurisdictionCreateShow=!0):"delete"===e&&this.$confirm("您确定要删除吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){Object(l["c"])({roleId:t.row.roleId}).then((function(e){a.list.splice(t.$index,1),a.$message({type:"success",message:"操作成功"})})).catch((function(){}))})).catch((function(){a.$message({type:"info",message:"已取消删除"})}))}}},w=_,k=(a("a67e"),Object(u["a"])(w,n,i,!1,null,"66b5ee5e",null));t["default"]=k.exports},b694:function(e,t,a){"use strict";a("fd75")},f468:function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("flexbox",{staticClass:"xr-header"},[e.iconClass?a("div",{staticClass:"xr-header__icon",style:{backgroundColor:e.iconColor}},[a("i",{class:e.iconClass})]):e._e(),e._v(" "),a("div",{staticClass:"xr-header__label"},[e.$slots.label?e._t("label"):[e._v(e._s(e.label)),e._t("otherLabel")]],2),e._v(" "),e.showSearch?a("el-input",e._b({staticClass:"xr-header__search",style:{"margin-top":e.ftTop},attrs:{placeholder:e.placeholder},on:{input:e.inputChange},nativeOn:{keyup:function(t){return!("button"in t)&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.searchClick(t)}},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}},"el-input",e.inputAttr,!1),[a("el-button",{attrs:{slot:"suffix",type:"icon",icon:"wk wk-sousuo"},on:{click:e.searchClick},slot:"suffix"})],1):e._e(),e._v(" "),a("div",{staticClass:"xr-header__ft",style:{top:e.ftTop}},[e._t("ft")],2)],1)},i=[],l=(a("a9e3"),a("ac1f"),a("841c"),{name:"XrHeader",components:{},props:{iconClass:[String,Array],iconColor:String,label:String,showSearch:{type:Boolean,default:!1},placeholder:{type:String,default:"请输入内容"},ftTop:{type:String,default:"0"},content:[String,Number],inputAttr:{type:Object,default:function(){}}},data:function(){return{search:""}},computed:{},watch:{content:{handler:function(){this.search!=this.content&&(this.search=this.content)},immediate:!0}},mounted:function(){},beforeDestroy:function(){},methods:{inputChange:function(){this.$emit("update:content",this.search)},searchClick:function(){this.$emit("search",this.search)}}}),o=l,s=(a("6f13"),a("2877")),c=Object(s["a"])(o,n,i,!1,null,"7eb05d11",null);t["a"]=c.exports},f4c8:function(e,t,a){},fd75:function(e,t,a){}}]);