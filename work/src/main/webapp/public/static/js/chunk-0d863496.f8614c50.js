(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0d863496"],{"091f":function(t,e,a){},"0cd1":function(t,e,a){"use strict";a("e86e")},"0cd3":function(t,e,a){},1557:function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"status-tag"},[a("span",{staticClass:"status-name",style:t.getStyle},[t._v(t._s(t.name))])])},i=[],s=(a("a9e3"),{name:"StatusTag",props:{type:[String,Number],statusName:String},data:function(){return{group:["",{color:"#0052CC","background-color":"#DEEBFF"},{color:"#EC8205","background-color":"#FFEACF"},{color:"#006644","background-color":"#E3FCEF"}]}},computed:{convertType:function(){return Number(this.type)},name:function(){return this.statusName?this.statusName:["","未开始","进行中","已完成"][this.convertType]},getStyle:function(){return this.group[this.convertType]}},methods:{}}),o=s,c=(a("77bc"),a("2877")),l=Object(c["a"])(o,n,i,!1,null,"2a8a7a12",null);e["a"]=l.exports},"308b":function(t,e,a){"use strict";a("c3d7")},"37a8":function(t,e,a){"use strict";a("7a24")},"47c8":function(t,e,a){},"77bc":function(t,e,a){"use strict";a("0cd3")},"78a3":function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"project-collaboration"},[a("el-tabs",{on:{"tab-click":t.handleClick},model:{value:t.activeName,callback:function(e){t.activeName=e},expression:"activeName"}},[t.backupShow?t._e():a("el-tab-pane",{attrs:{disabled:""}},[a("template",{slot:"label"},[t._v("\n        项目协同\n        "),a("span",{staticClass:"divider"})])],2),t._v(" "),t.backupShow?a("el-tab-pane",{attrs:{label:"",name:"backup"}},[a("span",{staticClass:"divider"}),t._v(" "),a("backup",{ref:"back",attrs:{"event-id":t.eventId,type:t.type},on:{"show-btn":t.handleShowBtn}})],1):a("el-tab-pane",{attrs:{label:"协作配置",name:"configuration"}},[a("configuration",{on:{backup:t.backupFn}})],1)],1),t._v(" "),t.backupShow?a("el-button",{staticClass:"return",attrs:{type:"text",icon:"wk wk-icon-circle-left"},on:{click:t.backClick}},[t._v("协作配置")]):t._e(),t._v(" "),a("div",{staticClass:"operate"},[t.showBtn?a("i",{staticClass:"el-icon-warning warning"},[t._v("正在编辑配置方案")]):t._e(),t._v(" "),t.showBtn?a("el-button",{staticStyle:{margin:"0 8px"},attrs:{type:"primary-text"},on:{click:t.handleDropEdit}},[t._v("\n      放弃编辑\n    ")]):t._e(),t._v(" "),t.showBtn?a("el-button",{attrs:{type:"primary"},on:{click:t.handleUseStatus}},[t._v("\n      应用方案\n    ")]):t._e()],1),t._v(" "),t.showStatusMove?a("map-status",{attrs:{visible:t.showStatusMove,"event-id":t.eventId,"all-list":t.allList},on:{"update:visible":function(e){t.showStatusMove=e},"save-success":t.handleSuccess,close:function(e){t.showStatusMove=!1}}}):t._e()],1)},i=[],s=(a("4de4"),a("d3b7"),a("e04a")),o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"configuration"},[a("div",{staticClass:"matter"},[a("div",{staticClass:"title"},[t._v("事项类型")]),t._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"main-table",class:t.WKConfig.tableStyle.class,staticStyle:{width:"100%"},attrs:{data:t.list,stripe:t.WKConfig.tableStyle.stripe,"highlight-current-row":""},on:{"row-click":t.handleRowClick}},[a("el-table-column",{attrs:{prop:"name",label:"事项类型名称",width:"200"},scopedSlots:t._u([{key:"default",fn:function(e){var n=e.row;return[a("flexbox",[a("img",{staticClass:"item-pic",attrs:{src:t.getIconClass(n)}}),t._v(" "),a("span",[t._v(t._s(n.name))])])]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"describes",label:"描述"}}),t._v(" "),a("el-table-column",{attrs:{fixed:"right",label:"操作",width:"200"},scopedSlots:t._u([{key:"default",fn:function(e){var n=e.row;return[a("el-button",{staticClass:"dropdown-btn",attrs:{disabled:!t.$auth("set.synergyConfig","PM"),type:"text",icon:"el-icon-s-operation"},on:{click:function(e){t.handleClick("a",n)}}})]}}])})],1)],1)])},c=[],l=a("a535"),r=a("6651"),u={name:"Configuration",components:{},props:{},data:function(){return{optionType:"universal",list:[],loading:!1,typelist:[],changeTypeShow:!0}},computed:{projectId:function(){return this.$route.params.setting}},watch:{},created:function(){},mounted:function(){this.typelist=[{name:"敏捷开发项目",desc:"通过内置的敏捷研发管理组件，可以轻松实现迭代管控、需求分配、缺陷管理等核心研发工作，通过各类报表实时掌控项目进度状况。"}],this.getDetail()},methods:{getDetail:function(){var t=this;this.loading=!0,Object(l["r"])({projectId:this.projectId}).then((function(e){var a=e.data||{};t.getList(a.schemeId),t.loading=!1})).catch((function(){t.loading=!1}))},getList:function(t){var e=this;this.loading=!0;var a={schemeId:t};Object(s["g"])(a).then((function(t){e.list=t.data||[],e.loading=!1})).catch((function(){e.loading=!1}))},handleRowClick:function(t,e,a){},handleClick:function(t,e){"a"===t&&this.$emit("backup",e)},getIconClass:function(t){var e=[0,2,3,4,"sub"][t.type],a={type:e};return Object(r["b"])(a)},switchType:function(t){this.optionType=t,this.$refs.popover.doClose()}}},d=u,p=(a("0cd1"),a("2877")),f=Object(p["a"])(d,o,c,!1,null,"5424c070",null),h=f.exports,v=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"backup"},[a("div",{staticClass:"card"},[a("flexbox",{staticClass:"favourite-list"},[a("div",{staticClass:"favourite-list-item"},[a("flexbox",{staticClass:"content"},[a("flexbox",{staticClass:"icon-box",attrs:{align:"center",justify:"center"}},[a("i",{staticClass:"wk wk-address-book"})]),t._v(" "),a("div",{staticClass:"info"},[a("div",{staticClass:"name text-one-line"},[t._v(t._s(t.title.btitle))]),t._v(" "),a("div",{staticClass:"desc text-one-line"},[t._v(t._s(t.title.stitle))])])],1)],1)])],1),t._v(" "),a("div",{staticClass:"workflow"},[a("div",{staticClass:"title"},[t._v("事项状态")]),t._v(" "),a("div",{staticClass:"container"},[a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"container-left"},[a("draggable",{attrs:{list:t.useStatusList},on:{end:function(e){t.moveEndTask(e,t.useStatusList)}}},t._l(t.useStatusList,(function(e,n){return a("div",{key:n,staticClass:"container-item"},[a("div",[a("span",{staticStyle:{"margin-right":"8px","font-weight":"bold",cursor:"move"}},[t._v("⋮⋮")]),t._v(" "),a("status-tag",{staticStyle:{width:"150px"},attrs:{type:e.statusType,"status-name":e.statusName}}),t._v(" "),a("span",{staticStyle:{"margin-left":"50px"}},[t._v(t._s(t.initStatus(e)))])],1),t._v(" "),a("el-dropdown",{attrs:{trigger:"click",placement:"bottom-start"},on:{command:function(a){t.handleCommand(a,e)}}},[a("el-button",{staticClass:"dropdown-btn",attrs:{type:"text",icon:"el-icon-more"}}),t._v(" "),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[a("el-dropdown-item",{attrs:{disabled:1==e.initStatus,command:"initial"}},[t._v("设为初始状态")]),t._v(" "),2==e.sysType?a("el-dropdown-item",{attrs:{disabled:1==e.initStatus,command:"delete"}},[t._v("移除")]):t._e()],1)],1)],1)})))],1)]),t._v(" "),a("el-button",{staticClass:"addbutton",attrs:{type:"text",icon:"el-icon-plus"},on:{click:t.addClick}},[t._v("添加状态")])],1),t._v(" "),a("add-status",{attrs:{visible:t.createVisible,action:t.action},on:{"update:visible":function(e){t.createVisible=e},"save-success":t.handleRefresh,close:function(e){t.createVisible=!1}}})],1)},m=[],b=(a("a9e3"),a("caad"),a("159b"),a("14d9"),a("b76a")),g=a.n(b),S=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{},[t.dialogVisible?a("el-dialog",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],attrs:{"append-to-body":!0,"close-on-click-modal":!1,visible:t.dialogVisible,title:t.title,width:"480px","custom-class":"no-padding-dialog"},on:{"update:visible":function(e){t.dialogVisible=e},close:t.handleClose}},[a("div",{staticClass:"main"},[a("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:t.ruleForm,rules:t.rules,"label-width":"100px"}},t._l(t.fieldList,(function(e,n){return a("el-form-item",{key:n,style:{width:e.width},attrs:{label:e.label,prop:e.field}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:e.placeholder},model:{value:t.ruleForm[e.field],callback:function(a){t.$set(t.ruleForm,e.field,a)},expression:"ruleForm[item.field]"}},t._l(t.options,(function(t){return a("el-option",{key:t.projectStatusId,attrs:{label:t.statusName,value:t.projectStatusId}},[a("status-tag",{attrs:{type:t.statusType,"status-name":t.statusName}})],1)})))],1)}))),t._v(" "),a("div",{staticClass:"btn-wrap",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{directives:[{name:"debounce",rawName:"v-debounce",value:t.handleConfirm,expression:"handleConfirm"}],attrs:{type:"primary"}},[t._v("保存")]),t._v(" "),a("el-button",{nativeOn:{click:function(e){return t.handleClose(e)}}},[t._v("取消")])],1)],1)]):t._e()],1)},w=[],y=a("5530"),C=(a("d81d"),a("1557")),_={name:"CreateItem",components:{StatusTag:C["a"]},props:{visible:{type:Boolean,required:!0,default:!1},action:{type:Object,default:function(){return{type:"save",data:null,id:""}}}},data:function(){return{loading:!1,dialogVisible:!1,fieldList:[{type:"select",label:"状态",field:"projectStatusId",placeholder:"请选择状态",width:"100%"}],ruleForm:{projectStatusId:""},rules:{projectStatusId:[{required:!0,message:"请选择状态",trigger:"change"}]},options:[]}},computed:{title:function(){return"".concat("save"==this.action.type?"新建":"编辑","状态")}},watch:{visible:{handler:function(t){this.initData(),this.dialogVisible=t},immediate:!0}},created:function(){this.getOptions()},methods:{initData:function(){if("update"==this.action.type){var t=this.action.data||{};this.ruleForm={projectStatusId:t.projectStatusId}}else this.ruleForm={projectStatusId:""}},getOptions:function(){var t=this,e={projectId:this.$route.params.setting,pageType:0,search:""};Object(s["j"])(e).then((function(e){t.options=(e.data.list||[]).map((function(t){return t.label=t.statusName,t.value=t.projectStatusId,t}))})).catch((function(){}))},handleClose:function(){this.dialogVisible=!1,this.$emit("update:visible",!1),this.$emit("close")},handleConfirm:function(){var t=this;this.$refs.ruleForm.validate((function(e){if(e){t.loading=!0;var a=Object(y["a"])({projectId:t.$route.params.setting,projectEventId:t.action.id},t.ruleForm);"update"==t.action.type&&(a.id=t.action.id);var n={save:s["d"],update:"a"}[t.action.type];n(a).then((function(e){t.$emit("save-success",{type:t.itemType}),t.loading=!1})).catch((function(){t.loading=!1}))}}))}}},j=_,k=(a("308b"),Object(p["a"])(j,S,w,!1,null,"66c42bfc",null)),x=k.exports,I={name:"Backup",components:{draggable:g.a,AddStatus:x,StatusTag:C["a"]},props:{eventId:[String,Number],type:[String,Number]},data:function(){return{loading:!1,useStatusList:[],allStatusList:[],createVisible:!1,action:{type:"save",id:this.eventId}}},computed:{title:function(){var t=[{btitle:"需求",stitle:"敏捷框架中最小的工作单元，是从用户角度描述软件如何为其带来特定的价值。"},{btitle:"任务",stitle:"任务是指为实现某个目标或需求所进行的具体活动。"},{btitle:"缺陷",stitle:"缺陷是指软件不符合最初定义的业务需求的现象，缺陷管理用于跟踪这些问题和错误。"},{btitle:"子工作项",stitle:"在敏捷模式下，将一个事项拆分成更小的块。"}][this.type-1];return t}},watch:{},created:function(){this.getList()},mounted:function(){},methods:{getList:function(){var t=this;this.loading=!0;var e={projectId:this.$route.params.setting,eventId:this.eventId};Object(s["f"])(e).then((function(e){var a=e.data||[];t.allStatusList=a;var n=a.some((function(t){return[0,2].includes(t.useStatus)}));t.$emit("show-btn",n),t.useStatusList=a.filter((function(t){return[0,1].includes(t.useStatus)})),t.loading=!1})).catch((function(){t.loading=!1}))},moveEndTask:function(t,e){var a=this,n=[];e.forEach((function(t){n.push(t.id)})),this.loading=!0,Object(s["m"])(n).then((function(t){a.loading=!1,a.$message.success("操作成功"),a.updateData()})).catch((function(){a.loading=!1}))},handleRefresh:function(){this.createVisible=!1,this.updateData()},updateData:function(){this.getList()},addClick:function(){this.createVisible=!0},initStatus:function(t){return 1==t.initStatus?"是初始状态":"非初始状态"},handleCommand:function(t,e){var a=this;if("delete"==t)this.$confirm("确定移除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var t={eventStatusId:e.id};Object(s["e"])(t).then((function(t){a.$message.success("操作成功"),a.updateData()})).catch((function(){}))})).catch((function(){}));else if("initial"==t){var n={eventId:this.eventId,projectStatusId:e.id};Object(s["l"])(n).then((function(t){a.$message.success("操作成功"),a.updateData()})).catch((function(){}))}}}},$=I,O=(a("c13e"),Object(p["a"])($,v,m,!1,null,"0981e6e5",null)),L=O.exports,T=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{},[t.dialogVisible?a("el-dialog",{ref:"wkDialog",attrs:{"append-to-body":!0,"close-on-click-modal":!1,visible:t.dialogVisible,title:"迁移事项的状态",width:"500px","custom-class":"no-padding-dialog"},on:{"update:visible":function(e){t.dialogVisible=e},close:t.handleClose}},[a("div",{staticClass:"main"},[a("div",{staticClass:"demo-rule-form"},t._l(t.fieldList,(function(e,n){return a("div",{key:n,staticClass:"table-wrap"},["title"==e.type?[a("div",{staticClass:"row-wrap"},[a("div",{staticClass:"item-left",staticStyle:{padding:"8px 16px"}},[t._v(t._s(e.old))]),t._v(" "),a("div",{staticClass:"item-right",staticStyle:{padding:"8px 16px"}},[t._v(t._s(e.new))])])]:"select"==e.type?[a("div",{staticClass:"row-wrap"},[a("div",{staticClass:"item-left"},[a("status-tag",{attrs:{type:e.old.statusType,"status-name":e.old.statusName}})],1),t._v(" "),a("div",{staticClass:"item-right"},[a("el-dropdown",{staticClass:"dropdown-status-btn",on:{command:function(e){t.handleSelectStatus(e,n)}}},[a("div",[e.new?a("status-tag",{attrs:{type:e.new.statusType,"status-name":e.new.statusName}}):a("span",{staticStyle:{color:"#b8c0cb"}},[t._v("请选择事项状态")]),t._v(" "),a("i",{staticClass:"el-icon-arrow-down el-icon--right"})],1),t._v(" "),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},t._l(t.options,(function(t,e){return a("el-dropdown-item",{key:e,attrs:{command:t}},[a("span",{staticStyle:{padding:"5px"}},[a("status-tag",{attrs:{type:t.statusType,"status-name":t.statusName}})],1)])})))],1)],1)])]:t._e()],2)}))),t._v(" "),a("div",{staticClass:"btn-wrap",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{directives:[{name:"debounce",rawName:"v-debounce",value:t.handleConfirm,expression:"handleConfirm"}],attrs:{type:"primary"}},[t._v("保存")]),t._v(" "),a("el-button",{nativeOn:{click:function(e){return t.handleClose(e)}}},[t._v("取消")])],1)])]):t._e()],1)},E=[],N=a("b85c"),F=(a("fb6a"),a("9dba")),V=a("2f62"),B={name:"MapStatus",components:{StatusTag:C["a"]},mixins:[F["a"]],props:{visible:{type:Boolean,required:!0,default:!1},allList:{type:Array,default:function(){return[]}},eventId:[String,Number]},data:function(){return{dialogVisible:!1,loading:!1,fieldList:[{type:"title",old:"即将删除的状态",new:"请选择事项状态"}],options:[]}},computed:Object(y["a"])({},Object(V["b"])(["userInfo"])),watch:{visible:{handler:function(t){var e=this;if(t){this.options=this.allList.filter((function(t){return[0,1].includes(t.useStatus)}));var a=this.allList.filter((function(t){return 2==t.useStatus}));a.forEach((function(t,a){e.fieldList.push({type:"select",old:t,new:""})}))}this.dialogVisible=t},immediate:!0}},methods:{handleClose:function(){this.dialogVisible=!1,this.$emit("update:visible",!1),this.$emit("close")},handleSelectStatus:function(t,e){this.$set(this.fieldList[e],"new",t)},handleConfirm:function(){var t,e=this,a={eventId:this.eventId,sourceStatus:[],transferStatus:[]},n=Object(N["a"])(this.fieldList.slice(1));try{for(n.s();!(t=n.n()).done;){var i=t.value;if(!i.new)return this.$message.error("请选择迁移状态");a.sourceStatus.push(i.old.id),a.transferStatus.push(i.new.id)}}catch(o){n.e(o)}finally{n.f()}this.loading=!0,Object(s["c"])(a).then((function(t){e.$message.success("迁移成功"),e.$emit("save-success"),e.handleClose(),e.loading=!1})).catch((function(){e.loading=!1}))}}},D=B,M=(a("c7ed"),Object(p["a"])(D,T,E,!1,null,"40231f5a",null)),A=M.exports,q={name:"ProjectTeam",components:{Configuration:h,Backup:L,MapStatus:A},data:function(){return{activeName:"configuration",backupShow:!1,rowData:null,eventId:"",type:"",useStatusList:[],hasAdd:!1,showStatusMove:!1,allList:[]}},computed:{showBtn:function(){return!(!this.hasAdd||!this.backupShow)}},created:function(){},methods:{handleClick:function(){},backupFn:function(t){this.rowData=t,this.eventId=t.id,this.type=t.type,this.backupShow=!0,this.activeName="backup"},backClick:function(){this.backupShow=!1,this.activeName="configuration"},handleShowBtn:function(t){this.hasAdd=t},handleSuccess:function(){this.$refs.back.getList()},handleUseStatus:function(){var t=this;this.allList=this.$refs.back.allStatusList;var e=this.allList.filter((function(t){return 2==t.useStatus})),a={eventId:this.eventId,sourceStatus:[],transferStatus:[]};e.length?this.showStatusMove=!0:this.$confirm("确定应用方案？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){Object(s["c"])(a).then((function(e){t.$message.success("应用成功"),t.$refs.back.getList()})).catch((function(){}))})).catch((function(){}))},handleDropEdit:function(){var t=this;this.$confirm("确定放弃编辑？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){Object(s["a"])({eventId:t.eventId}).then((function(){t.$message.success("操作成功"),t.$refs.back.getList()}))})).catch((function(){}))}}},R=q,P=(a("37a8"),Object(p["a"])(R,n,i,!1,null,"033f4736",null));e["default"]=P.exports},"7a24":function(t,e,a){},"9dba":function(t,e,a){"use strict";e["a"]={watch:{loading:function(t){if(t){var e=this.$refs.wkDialog.$refs.dialog;this.loadingInstance=this.$loading({target:e})}else this.loadingInstance&&this.loadingInstance.close()}}}},c13e:function(t,e,a){"use strict";a("47c8")},c3d7:function(t,e,a){},c7ed:function(t,e,a){"use strict";a("091f")},e04a:function(t,e,a){"use strict";a.d(e,"h",(function(){return i})),a.d(e,"k",(function(){return s})),a.d(e,"j",(function(){return o})),a.d(e,"i",(function(){return c})),a.d(e,"g",(function(){return l})),a.d(e,"d",(function(){return r})),a.d(e,"e",(function(){return u})),a.d(e,"f",(function(){return d})),a.d(e,"b",(function(){return p})),a.d(e,"c",(function(){return f})),a.d(e,"l",(function(){return h})),a.d(e,"a",(function(){return v})),a.d(e,"m",(function(){return m}));var n=a("b775");function i(t){return Object(n["a"])({url:"projectStatus/add",method:"post",headers:{"Content-Type":"application/json;charset=utf-8;"},data:t})}function s(t){return Object(n["a"])({url:"projectStatus/update",method:"post",headers:{"Content-Type":"application/json;charset=utf-8;"},data:t})}function o(t){return Object(n["a"])({url:"projectStatus/queryProjectStatusList",method:"post",headers:{"Content-Type":"application/json;charset=utf-8;"},data:t})}function c(t){return Object(n["a"])({url:"projectStatus/delete",method:"post",data:t})}function l(t){return Object(n["a"])({url:"projectEvent/queryEventList",method:"post",data:t})}function r(t){return Object(n["a"])({url:"projectEventStatus/add",method:"post",headers:{"Content-Type":"application/json;charset=utf-8;"},data:t})}function u(t){return Object(n["a"])({url:"projectEventStatus/remove",method:"post",data:t})}function d(t){return Object(n["a"])({url:"projectEventStatus/applicationSchemeStatusList",method:"post",data:t})}function p(t){return Object(n["a"])({url:"projectEventStatus/list",method:"post",data:t})}function f(t){return Object(n["a"])({url:"projectEventStatus/transferStatus",method:"post",headers:{"Content-Type":"application/json;charset=utf-8;"},data:t})}function h(t){return Object(n["a"])({url:"projectEventStatus/updateInitStatus",method:"post",data:t})}function v(t){return Object(n["a"])({url:"projectEventStatus/giveUpApplicationScheme",method:"post",data:t})}function m(t){return Object(n["a"])({url:"projectEventStatus/updateSorting",method:"post",headers:{"Content-Type":"application/json;charset=utf-8;"},data:t})}},e86e:function(t,e,a){}}]);